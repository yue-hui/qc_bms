(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-2d8c"],{"+BHT":function(e,t,r){},"12yw":function(e,t,r){"use strict";r.d(t,"h",function(){return a}),r.d(t,"b",function(){return n}),r.d(t,"g",function(){return o}),r.d(t,"f",function(){return u}),r.d(t,"e",function(){return i}),r.d(t,"d",function(){return l}),r.d(t,"a",function(){return s}),r.d(t,"c",function(){return c});var a=[{value:"01",label:"启动中"},{value:"00",label:"未启动"},{value:"02",label:"已停止"}],n=[{value:"1",label:"格雷盒子家长端",select_item:{update_platforms:[{value:"01",label:"IOS家长端"},{value:"11",label:"安卓家长端"}],update_models:[{value:"0",label:"推荐升级",disabled:!1},{value:"1",label:"强制升级",disabled:!1}],update_ranges:[{value:"01",label:"全量"},{value:"03",label:"用户手机"}]}},{value:"2",label:"格雷盒子孩子端",select_item:{update_platforms:[{value:"02",label:"IOS孩子端"},{value:"F2",label:"安卓孩子端"}],update_models:[{value:"0",label:"推荐升级",disabled:!0},{value:"1",label:"强制升级",disabled:!1}],update_ranges:[{value:"01",label:"全量"},{value:"02",label:"设备ID白名单"}]}},{value:"3",label:"定制机孩子端",select_item:{update_platforms:[{value:"12",label:"VIVO孩子端"},{value:"22",label:"OPPO孩子端"},{value:"42",label:"小格雷定制机"},{value:"52",label:"小米企业模式"},{value:"62",label:"VIVO政企Y3"}],update_models:[{value:"0",label:"推荐升级",disabled:!0},{value:"1",label:"强制升级",disabled:!1}],update_ranges:[{value:"01",label:"全量"},{value:"02",label:"设备ID白名单"}]}},{value:"4",label:"中间件",select_item:{update_platforms:[{value:"13",label:"VIVO中间件"},{value:"23",label:"OPPO中间件"},{value:"43",label:"小格雷中间件"},{value:"53",label:"小米企业模式中间件"},{value:"63",label:"VIVO政企Y3中间件"}],update_models:[{value:"0",label:"推荐升级",disabled:!1},{value:"1",label:"强制升级",disabled:!1}],update_ranges:[{value:"01",label:"全量"},{value:"02",label:"设备ID白名单"}]}}],o=[{value:"01",label:"IOS家长端"},{value:"11",label:"安卓家长端"},{value:"02",label:"IOS孩子端"},{value:"F2",label:"安卓孩子端"},{value:"12",label:"vivo孩子端"},{value:"22",label:"oppo孩子端"},{value:"42",label:"小格雷定制机"},{value:"52",label:"小米企业模式孩子端"},{value:"62",label:"vivo Y3孩子端"},{value:"13",label:"vivo中间件"},{value:"23",label:"oppo中间件"},{value:"43",label:"小格雷中间件"},{value:"53",label:"小米企业模式中间件"},{value:"63",label:"vivo Y3中间件"}],u=[{value:"01",label:"IOS家长端"},{value:"11",label:"安卓家长端"},{value:"02",label:"IOS孩子端"},{value:"F2",label:"安卓孩子端"},{value:"12",label:"vivo孩子端"},{value:"22",label:"oppo安卓孩子端"},{value:"42",label:"小格雷定制机"},{value:"52",label:"小米企业模式孩子端"},{value:"62",label:"vivo Y3孩子端"},{value:"13",label:"孩子端+vivo中间件"},{value:"23",label:"孩子端+oppo中间件"},{value:"43",label:"孩子端+小格雷中间件"},{value:"53",label:"小米企业模式中间件"},{value:"63",label:"vivo Y3中间件"}],i=[{value:"0",label:"待生效"},{value:"1",label:"已生效"}],l=[{value:"",label:"不限"},{value:"01",label:"PC"},{value:"02",label:"IOS"},{value:"03",label:"Android"}],s=[{value:"00",label:"不限"},{value:"01",label:"PC"},{value:"02",label:"IOS"},{value:"03",label:"Android"}],c=[{value:"01",label:"PC端"},{value:"02",label:"苹果"},{value:"03",label:"安卓"}]},OkP0:function(e,t,r){"use strict";var a=r("ilBh");r.n(a).a},OvEM:function(e,t,r){"use strict";var a=r("+BHT");r.n(a).a},S583:function(e,t,r){"use strict";r.d(t,"yb",function(){return n}),r.d(t,"xb",function(){return o}),r.d(t,"wb",function(){return u}),r.d(t,"P",function(){return i}),r.d(t,"O",function(){return l}),r.d(t,"hb",function(){return s}),r.d(t,"gb",function(){return c}),r.d(t,"Zb",function(){return d}),r.d(t,"Ab",function(){return p}),r.d(t,"Bb",function(){return m}),r.d(t,"zb",function(){return f}),r.d(t,"bc",function(){return g}),r.d(t,"ub",function(){return _}),r.d(t,"gc",function(){return b}),r.d(t,"Z",function(){return h}),r.d(t,"cb",function(){return v}),r.d(t,"Xb",function(){return O}),r.d(t,"Y",function(){return y}),r.d(t,"ab",function(){return j}),r.d(t,"Cb",function(){return w}),r.d(t,"Eb",function(){return k}),r.d(t,"g",function(){return x}),r.d(t,"ic",function(){return z}),r.d(t,"Db",function(){return $}),r.d(t,"r",function(){return C}),r.d(t,"Wb",function(){return q}),r.d(t,"Vb",function(){return S}),r.d(t,"Ub",function(){return I}),r.d(t,"Rb",function(){return B}),r.d(t,"Tb",function(){return D}),r.d(t,"Sb",function(){return U}),r.d(t,"Qb",function(){return P}),r.d(t,"Yb",function(){return V}),r.d(t,"V",function(){return T}),r.d(t,"U",function(){return N}),r.d(t,"mb",function(){return E}),r.d(t,"l",function(){return Y}),r.d(t,"H",function(){return L}),r.d(t,"M",function(){return M}),r.d(t,"ec",function(){return R}),r.d(t,"Ib",function(){return A}),r.d(t,"k",function(){return J}),r.d(t,"L",function(){return F}),r.d(t,"Jb",function(){return Z}),r.d(t,"G",function(){return H}),r.d(t,"v",function(){return W}),r.d(t,"u",function(){return K}),r.d(t,"T",function(){return X}),r.d(t,"b",function(){return Q}),r.d(t,"t",function(){return G}),r.d(t,"fc",function(){return ee}),r.d(t,"z",function(){return te}),r.d(t,"S",function(){return re}),r.d(t,"vb",function(){return ae}),r.d(t,"rb",function(){return ne}),r.d(t,"sb",function(){return oe}),r.d(t,"Q",function(){return ue}),r.d(t,"o",function(){return ie}),r.d(t,"e",function(){return le}),r.d(t,"hc",function(){return se}),r.d(t,"pb",function(){return ce}),r.d(t,"ob",function(){return de}),r.d(t,"qb",function(){return pe}),r.d(t,"d",function(){return me}),r.d(t,"D",function(){return fe}),r.d(t,"N",function(){return ge}),r.d(t,"a",function(){return _e}),r.d(t,"y",function(){return be}),r.d(t,"n",function(){return he}),r.d(t,"ac",function(){return ve}),r.d(t,"Gb",function(){return Oe}),r.d(t,"j",function(){return ye}),r.d(t,"F",function(){return je}),r.d(t,"K",function(){return we}),r.d(t,"Fb",function(){return ke}),r.d(t,"cc",function(){return xe}),r.d(t,"Lb",function(){return ze}),r.d(t,"Kb",function(){return $e}),r.d(t,"Mb",function(){return Ce}),r.d(t,"m",function(){return qe}),r.d(t,"I",function(){return Se}),r.d(t,"s",function(){return Ie}),r.d(t,"fb",function(){return Be}),r.d(t,"eb",function(){return De}),r.d(t,"c",function(){return Ue}),r.d(t,"B",function(){return Pe}),r.d(t,"q",function(){return Ve}),r.d(t,"jb",function(){return Te}),r.d(t,"ib",function(){return Ne}),r.d(t,"C",function(){return Ee}),r.d(t,"A",function(){return Ye}),r.d(t,"W",function(){return Le}),r.d(t,"X",function(){return Me}),r.d(t,"kb",function(){return Re}),r.d(t,"nb",function(){return Ae}),r.d(t,"lb",function(){return Je}),r.d(t,"x",function(){return Fe}),r.d(t,"Hb",function(){return Ze}),r.d(t,"tb",function(){return He}),r.d(t,"f",function(){return We}),r.d(t,"E",function(){return Ke}),r.d(t,"p",function(){return Xe}),r.d(t,"Pb",function(){return Qe}),r.d(t,"i",function(){return Ge}),r.d(t,"J",function(){return et}),r.d(t,"dc",function(){return tt}),r.d(t,"Ob",function(){return rt}),r.d(t,"R",function(){return at}),r.d(t,"Nb",function(){return nt}),r.d(t,"h",function(){return ot}),r.d(t,"w",function(){return ut}),r.d(t,"db",function(){return it}),r.d(t,"bb",function(){return lt});var a=r("t3Un");function n(){return Object(a.a)({url:"/greenguard/common/order/type/list",method:"post"})}function o(){return Object(a.a)({url:"/greenguard/common/order/status/list",method:"post"})}function u(){return Object(a.a)({url:"/greenguard/common/order/paytype/list",method:"post"})}function i(){return Object(a.a)({url:"/greenguard/common/advertising/type/list",method:"post"})}function l(){return Object(a.a)({url:"/greenguard/common/advertising/point/list",method:"post"})}function s(){return Object(a.a)({url:"/greenguard/manager/index/summary",method:"post"})}function c(e){return Object(a.a)({url:"/greenguard/manager/index/list",method:"post",data:e})}function d(e){return Object(a.a)({url:"/greenguard/common/user/reg_from/list",method:"post",data:e})}function p(e){return Object(a.a)({url:"/greenguard/manager/user/patriarch/list",method:"post",data:e})}function m(e){return Object(a.a)({url:"/greenguard/manager/user/patriarch/list/export",method:"post",data:e})}function f(e){return Object(a.a)({url:"/greenguard/manager/user/patriarch/detail",method:"post",data:e})}function g(e){return Object(a.a)({url:"/greenguard/manager/member/monthlyplan/unsubscribe/ctccsp",method:"post",data:e})}function _(e){return Object(a.a)({url:"/greenguard/manager/member/monthlyplan/unsubscribe/list",method:"post",data:e})}function b(e){return Object(a.a)({url:"/greenguard/manager/device/unbind",method:"post",data:e})}function h(e){return Object(a.a)({url:"/greenguard/manager/user/patriarch/child_device/record/list",method:"post",data:e})}function v(e){return Object(a.a)({url:"/greenguard/manager/device/info/list",method:"post",data:e})}function O(e){return Object(a.a)({url:"/greenguard/manager/user/child/list",method:"post",data:e})}function y(e){return Object(a.a)({url:"/greenguard/manager/user/child/list/export",method:"post",data:e})}function j(e){return Object(a.a)({url:"/greenguard/manager/device/getAppUsage",method:"post",data:e})}function w(e){return Object(a.a)({url:"/greenguard/manager/qa/type/list",method:"post",data:e})}function k(e){return Object(a.a)({url:"/greenguard/manager/qa/list",method:"post",data:e})}function x(e){return Object(a.a)({url:"/greenguard/manager/qa/add",method:"post",data:e})}function z(e){return Object(a.a)({url:"/greenguard/manager/qa/edit",method:"post",data:e})}function $(e){return Object(a.a)({url:"/greenguard/manager/qa/detail",method:"post",data:e})}function C(e){return Object(a.a)({url:"/greenguard/manager/qa/delete",method:"post",data:e})}function q(e){return Object(a.a)({url:"/greenguard/manager/user/analyze/summary",method:"post",data:e})}function S(e){return Object(a.a)({url:"/greenguard/manager/user/analyze/list",method:"post",data:e})}function I(e){return Object(a.a)({url:"/greenguard/manager/user/analyze/child/summary",method:"post",data:e})}function B(e){return Object(a.a)({url:"/greenguard/manager/user/analyze/child/increased",method:"post",data:e})}function D(e){return Object(a.a)({url:"/greenguard/manager/user/analyze/child/increased/bind_user",method:"post",data:e})}function U(e){return Object(a.a)({url:"/greenguard/manager/user/analyze/child/increased/bind_device",method:"post",data:e})}function P(e){return Object(a.a)({url:"/greenguard/manager/user/analyze/child/list",method:"post",data:e})}function V(e){return Object(a.a)({url:"/greenguard/manager/user/analyze/increased",method:"post",data:e})}function T(e){return Object(a.a)({url:"/greenguard/manager/user/analyze/increased/bind_user",method:"post",data:e})}function N(e){return Object(a.a)({url:"/greenguard/manager/user/analyze/increased/bind_device",method:"post",data:e})}function E(e){return Object(a.a)({url:"/greenguard/manager/soft/recommend/list",method:"post",data:e})}function Y(e){return Object(a.a)({url:"/greenguard/manager/soft/recommend/add",method:"post",data:e})}function L(e){return Object(a.a)({url:"/greenguard/manager/soft/recommend/edit",method:"post",data:e})}function M(e){return Object(a.a)({url:"/greenguard/manager/soft/recommend/delete",method:"post",data:e})}function R(e){return Object(a.a)({url:"/greenguard/manager/soft/recommend/mark/search",method:"post",data:e})}function A(e){return Object(a.a)({url:"/greenguard/manager/soft/recommend/group/list",method:"post",data:e})}function J(e){return Object(a.a)({url:"/greenguard/manager/soft/recommend/group/add",method:"post",data:e})}function F(e){return Object(a.a)({url:"/greenguard/manager/soft/recommend/group/delete",method:"post",data:e})}function Z(e){return Object(a.a)({url:"/greenguard/manager/soft/recommend/group/detail",method:"post",data:e})}function H(e){return Object(a.a)({url:"/greenguard/manager/soft/recommend/group/edit",method:"post",data:e})}function W(e){return Object(a.a)({url:"/greenguard/manager/soft/recommend/group/publish",method:"post",data:e})}function K(e){return Object(a.a)({url:"/greenguard/manager/qa/publish",method:"post",data:e})}function X(e){return Object(a.a)({url:"/greenguard/manager/app/version/list",method:"post",data:e})}function Q(e){return Object(a.a)({url:"/greenguard/manager/app/version/add",method:"post",data:e})}function G(e){return Object(a.a)({url:"/greenguard/manager/app/version/startup",method:"post",data:e})}function ee(e){return Object(a.a)({url:"/greenguard/manager/app/version/send/command",method:"post",data:e})}function te(e){return Object(a.a)({url:"/greenguard/manager/app/version/update",method:"post",data:e})}function re(e){return Object(a.a)({url:"/greenguard/manager/app/version/get",method:"post",data:e})}function ae(e){return Object(a.a)({url:"/greenguard/manager/order/list",method:"post",data:e})}function ne(e){return Object(a.a)({url:"/greenguard/manager/member/plan/flow/list",method:"post",data:e})}function oe(e){return Object(a.a)({url:"/greenguard/manager/member/plan/list",method:"post",data:e})}function ue(e){return Object(a.a)({url:"/greenguard/manager/member/plan/list/all",method:"post",data:e})}function ie(e){return Object(a.a)({url:"/greenguard/manager/member/plan/delete",method:"post",data:e})}function le(e){return Object(a.a)({url:"/greenguard/manager/member/plan/add",method:"post",data:e})}function se(e){return Object(a.a)({url:"/greenguard/manager/member/plan/edit",method:"post",data:e})}function ce(e){return Object(a.a)({url:"/greenguard/manager/member/activity/list",method:"post",data:e})}function de(e){return Object(a.a)({url:"/greenguard/manager/member/activity/info",method:"post",data:e})}function pe(e){return Object(a.a)({url:"/greenguard/manager/member/activity/user/list",method:"post",data:e})}function me(e){return Object(a.a)({url:"/greenguard/manager/member/activity/add",method:"post",data:e})}function fe(e){return Object(a.a)({url:"/greenguard/manager/member/activity/edit",method:"post",data:e})}function ge(e){return Object(a.a)({url:"/greenguard/manager/advertising/list",method:"post",data:e})}function _e(e){return Object(a.a)({url:"/greenguard/manager/advertising/add",method:"post",data:e})}function be(e){return Object(a.a)({url:"/greenguard/manager/advertising/edit",method:"post",data:e})}function he(e){return Object(a.a)({url:"/greenguard/manager/advertising/delete",method:"post",data:e})}function ve(e){return Object(a.a)({url:"/greenguard/manager/app/version/distribution",method:"post",data:e})}function Oe(e){return Object(a.a)({url:"/greenguard/manager/soft/recommend/subject/list",method:"post",data:e})}function ye(e){return Object(a.a)({url:"/greenguard/manager/soft/recommend/subject/add",method:"post",data:e})}function je(e){return Object(a.a)({url:"/greenguard/manager/soft/recommend/subject/edit",method:"post",data:e})}function we(e){return Object(a.a)({url:"/greenguard/manager/soft/recommend/subject/delete",method:"post",data:e})}function ke(e){return Object(a.a)({url:"/greenguard/manager/soft/recommend/subject/detail",method:"post",data:e})}function xe(e){return Object(a.a)({url:"/greenguard/manager/soft/recommend/subject/publish",method:"post",data:e})}function ze(e){return Object(a.a)({url:"/greenguard/manager/sys/param/list",method:"post",data:e})}function $e(e){return Object(a.a)({url:"/greenguard/manager/sys/param/get",method:"post",data:e})}function Ce(e){return Object(a.a)({url:"/greenguard/manager/sys/param/get/type/list",method:"post",data:e})}function qe(e){return Object(a.a)({url:"/greenguard/manager/sys/param/add",method:"post",data:e})}function Se(e){return Object(a.a)({url:"/greenguard/manager/sys/param/edit",method:"post",data:e})}function Ie(e){return Object(a.a)({url:"/greenguard/manager/sys/param/delete",method:"post",data:e})}function Be(e){return Object(a.a)({url:"/greenguard/manager/risk/soft/list",method:"post",data:e})}function De(e){return Object(a.a)({url:"/greenguard/manager/risk/soft/get",method:"post",data:e})}function Ue(e){return Object(a.a)({url:"/greenguard/manager/risk/soft/add",method:"post",data:e})}function Pe(e){return Object(a.a)({url:"/greenguard/manager/risk/soft/edit",method:"post",data:e})}function Ve(e){return Object(a.a)({url:"/greenguard/manager/risk/soft/delete",method:"post",data:e})}function Te(e){return Object(a.a)({url:"/greenguard/manager/user/invite/register/statistics/list",method:"post",data:e})}function Ne(){return Object(a.a)({url:"/greenguard/manager/user/invite/register/activity/info",method:"post"})}function Ee(e){return Object(a.a)({url:"/greenguard/manager/user/invite/register/activity/edit",method:"post",data:e})}function Ye(e){return Object(a.a)({url:"/greenguard/manager/channel/saveOrUpdate",method:"post",data:e})}function Le(e){return Object(a.a)({url:"/greenguard/manager/channel/info",method:"post",data:e})}function Me(e){return Object(a.a)({url:"/greenguard/manager/channel/list",method:"post",data:e})}function Re(e){return Object(a.a)({url:"/greenguard/manager/channel/associated/user",method:"post",data:e})}function Ae(e){return Object(a.a)({url:"/greenguard/manager/voice/query/record",method:"post",data:e})}function Je(e){return Object(a.a)({url:"/greenguard/manager/sms/query/record",method:"post",data:e})}function Fe(e){return Object(a.a)({url:"/greenguard/manager/user/profile/unbind",method:"post",data:e})}function Ze(e){return Object(a.a)({url:"/greenguard/manager/index/querySoftByBundleId",method:"post",data:e})}function He(e){return Object(a.a)({url:"/greenguard/manager/miniprogram/list",method:"post",data:e})}function We(e){return Object(a.a)({url:"/greenguard/manager/miniprogram/add",method:"post",data:e})}function Ke(e){return Object(a.a)({url:"/greenguard/manager/miniprogram/edit",method:"post",data:e})}function Xe(e){return Object(a.a)({url:"/greenguard/manager/miniprogram/del",method:"post",data:e})}function Qe(e){return Object(a.a)({url:"/greenguard/manager/user/list",method:"post",data:e})}function Ge(e){return Object(a.a)({url:"/greenguard/manager/user/saveOrUpdate",method:"post",data:e})}function et(e){return Object(a.a)({url:"/greenguard/manager/user/updateState",method:"post",data:e})}function tt(e){return Object(a.a)({url:"/greenguard/manager/user/password/reset",method:"post",data:e})}function rt(e){return Object(a.a)({url:"/greenguard/manager/sysRole/list",method:"post",data:e})}function at(e){return Object(a.a)({url:"/greenguard/manager/sysRole/list/all",method:"post",data:e})}function nt(e){return Object(a.a)({url:"/ns-permission/roles/greenguard/manager/sysRole/info",method:"post",data:e})}function ot(e){return Object(a.a)({url:"/ns-permission/roles/greenguard/manager/sysRole/saveOrUpdate",method:"post",data:e})}function ut(e){return Object(a.a)({url:"/greenguard/manager/device/addMobileLog",method:"post",data:e})}function it(e){return Object(a.a)({url:"/greenguard/manager/device/findMobileLog",method:"post",data:e})}function lt(e){return Object(a.a)({url:"/greenguard/manager/device/findAliLog",method:"post",data:e})}},ZbUW:function(e,t,r){"use strict";r.r(t);var a=r("QbLZ"),n=r.n(a),o=r("12yw"),u=r("S583"),i=r("YP4+"),l=r("Zkmf"),s=r("z0WU"),c={name:"VersionDialog",props:{showDialog:{type:Boolean,required:!0,default:!1},isNew:{type:Boolean,required:!0,default:!1},rid:{type:String,default:""}},data:function(){var e=this,t=[],r=[],a=[];o.b.length&&(t=o.b[0].select_item.update_platforms,r=o.b[0].select_item.update_ranges,a=o.b[0].select_item.update_models);return{bms_platform_classification:o.b,update_platforms:t,update_models:a,update_ranges:r,is_busy:!1,need_upload_app_package:!1,upload_file_list:[],form:{app_version:"",file_size:"",update_url:"",update_title:"",current_platform_classification:"",platform:"",is_force:"",publish_type:"",white_list:"",is_remind:"1",update_desc:"",start_strage:"1",end_strage:"1"},rules:{app_version:[{required:!0,trigger:"blur",message:"目标版本号不能为空"}],file_size:[{type:"string",required:!0,message:"包大小只能输入数字",trigger:"blur",pattern:i.K}],update_title:[{required:!0,trigger:"blur",message:"策略名称为必填项"},{max:12,trigger:"blur",message:"策略名称长度不能超过12个字"}],current_platform_classification:[{required:!0,trigger:"blur",message:"升级产品为必选项"}],platform:[{required:!0,trigger:"blur",message:"升级平台为必选项"}],is_force:[{required:!0,trigger:"blur",message:"升级方式为必选项"}],publish_type:[{trigger:"blur",validator:function(e,t,a){0!==r.length?t?a():a(new Error("升级范围请选择全量或白名单")):a()}}],white_list:[{trigger:"blur",validator:function(t,r,a){-1!==["02","03"].indexOf(e.form.publish_type)?e.form.white_list?a():a(new Error("白名单不能为空")):a()}}],start_strage:[{required:!0,trigger:"blur",message:"策略启动条件为必选项"}],end_strage:[{required:!0,trigger:"blur",message:"策略停止条件为必选项"}],is_remind:[{required:!0,trigger:"blur",message:"自动弹框规则为必选项"}],update_desc:[{required:!0,trigger:"blur",message:"升级说明不能为空"}]}}},computed:{title:function(){return this.isNew?"创建升级应用策略":"编辑升级应用策略"},show_save_label:function(){return this.isNew?"创 建":"保 存"}},watch:{},mounted:function(){this.isNew?this.form=this.init_application_version():this.fetch_application_version()},methods:{init_application_version:function(){return{app_version:"",file_size:"",update_url:"",update_title:"",current_platform_classification:"",platform:"",is_force:"",publish_type:"",white_list:"",is_remind:"1",update_desc:"",start_strage:"1",end_strage:"1"}},reflect_platform_classification:function(e){var t,r=o.b[0];return o.b.map(function(t){t.select_item.update_platforms.map(function(a){a.value===e&&(r=t)})}),t=r.value,this.change_platform_classification(t),t},fetch_application_version:function(){var e=this,t={version_id:this.rid};Object(u.S)(t).then(function(t){if(0===t.status){var r=t.data,a=r.version,n=e.reflect_platform_classification(r.platform);e.form={app_version:a,version_id:r.version_id,file_size:r.file_size,update_url:r.update_url,update_title:r.update_title,current_platform_classification:n,platform:r.platform,is_force:r.is_force,publish_type:r.publish_type,white_list:r.white_list||"",is_remind:r.is_remind,update_desc:r.update_desc,start_strage:"1",end_strage:"1"}}else e.$message.error(t.message)})},change_platform_classification:function(e){var t=o.b.filter(function(t){return t.value===e})[0].select_item;this.update_platforms=t.update_platforms,this.update_ranges=t.update_ranges,this.update_models=t.update_models,this.form.platform="",this.need_upload_app_package=!1,this.form.update_url="",this.form.publish_type="",this.change_update_platform(e)},change_update_platform:function(e){-1!==["01","02"].indexOf(e)?this.need_upload_app_package=!1:this.need_upload_app_package=!0},push_picture_to_cloud:function(e){var t=this;if(this.upload_file_list>=1)this.$message.warning("只能上传一张图片");else{var r=e.file;this.form.update_url="",Object(l.a)(r).then(function(a){var n=a.data;if(-1!==[1,-2,"-2"].indexOf(n.status))Object(l.b)(r).then(function(r){var a=r.data;if(0===a.status){var n=a.data.url,o={name:e.file.name,url:n};t.upload_file_list.push(o),t.form.update_url=o.url}else t.$message.error(a.message)});else if(-1===n.status)t.$message.error(n.message);else if(0===n.status){var o=n.data.url,u={name:e.file.name,url:o};t.upload_file_list.push(u),t.form.update_url=u.url,t.$message.success("上传成功")}else t.$message.error(n.message)})}},remove_picture:function(){this.upload_file_list=[],this.form.update_url=""},close_dialog:function(){var e=this;this.$confirm("确认关闭？").then(function(t){e.cancel_dialog()}).catch(function(e){})},create_version:function(){var e=this,t=Object(s.q)(this.form);t.update_url||delete t.update_url,this.is_busy=!0,Object(u.b)(t).then(function(t){0===t.status?e.$emit("destory",!0):(e.$message.error(t.message),e.$emit("destory",!1))}).finally(function(){e.is_busy=!1})},edit_version:function(){var e=this,t=Object(s.q)(this.form);this.is_busy=!0,Object(u.z)(t).then(function(t){0===t.status?e.$emit("destory",!0):(e.$message.error(t.message),e.$emit("destory",!1))}).finally(function(){e.is_busy=!1})},create_update_strage:function(){var e=this;this.$refs.form.validate(function(t){t&&(e.isNew?e.create_version():e.edit_version())})},cancel_dialog:function(){this.$emit("destory",!1)}}},d=(r("kkwS"),r("KHd+")),p=Object(d.a)(c,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"component-card"},[r("el-dialog",{attrs:{title:e.title,visible:e.showDialog,"before-close":e.close_dialog,top:"0",size:"mini",width:"40%"},on:{"update:visible":function(t){e.showDialog=t}}},[r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-suffix":":",size:"mini","label-width":"120px"}},[r("span",{staticClass:"group-title"},[e._v("目标版本信息")]),e._v(" "),r("hr",{staticClass:"diviser"}),e._v(" "),r("el-form-item",{attrs:{label:"目标版本号",prop:"app_version"}},[r("el-input",{attrs:{placeholder:"请输入目标版本号"},model:{value:e.form.app_version,callback:function(t){e.$set(e.form,"app_version",t)},expression:"form.app_version"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"包大小",prop:"file_size"}},[r("el-input",{attrs:{type:"number",placeholder:"请输入目标版本包大小"},model:{value:e.form.file_size,callback:function(t){e.$set(e.form,"file_size",t)},expression:"form.file_size"}},[r("template",{slot:"append"},[e._v("MB")])],2)],1),e._v(" "),r("span",{staticClass:"group-title"},[e._v("基础策略配置")]),e._v(" "),r("hr",{staticClass:"diviser"}),e._v(" "),r("el-form-item",{attrs:{label:"策略名称",prop:"update_title"}},[r("el-input",{attrs:{placeholder:"请输入策略名称"},model:{value:e.form.update_title,callback:function(t){e.$set(e.form,"update_title",t)},expression:"form.update_title"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"升级产品",prop:"current_platform_classification"}},[r("el-select",{attrs:{size:"mini",placeholder:"升级产品"},on:{change:e.change_platform_classification},model:{value:e.form.current_platform_classification,callback:function(t){e.$set(e.form,"current_platform_classification",t)},expression:"form.current_platform_classification"}},e._l(e.bms_platform_classification,function(e,t){return r("el-option",{key:t,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"升级平台",prop:"platform"}},[r("el-radio-group",{model:{value:e.form.platform,callback:function(t){e.$set(e.form,"platform",t)},expression:"form.platform"}},[r("el-row",[r("el-col",e._l(e.update_platforms,function(t,a){return r("el-radio",{key:a,staticClass:"multi-radio-col",attrs:{label:t.value,title:t.label},on:{change:e.change_update_platform}},[e._v(e._s(t.label)+"\n              ")])}),1)],1)],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"升级方式",prop:"is_force"}},[r("el-radio-group",{model:{value:e.form.is_force,callback:function(t){e.$set(e.form,"is_force",t)},expression:"form.is_force"}},e._l(e.update_models,function(t,a){return r("el-radio",{key:a,attrs:{disabled:t.disabled,label:t.value}},[e._v("\n            "+e._s(t.label)+"\n          ")])}),1)],1),e._v(" "),0!==e.update_ranges.length?r("el-form-item",{attrs:{label:"升级范围",prop:"publish_type"}},[r("el-radio-group",{model:{value:e.form.publish_type,callback:function(t){e.$set(e.form,"publish_type",t)},expression:"form.publish_type"}},e._l(e.update_ranges,function(t,a){return r("el-radio",{key:a,attrs:{label:t.value}},[e._v("\n            "+e._s(t.label)+"\n          ")])}),1)],1):e._e(),e._v(" "),0!==e.update_ranges.length?r("el-form-item",{attrs:{label:"",prop:"white_list"}},[r("el-input",{attrs:{disabled:-1===["02","03"].indexOf(e.form.publish_type),rows:3,resize:"none",type:"textarea"},model:{value:e.form.white_list,callback:function(t){e.$set(e.form,"white_list",t)},expression:"form.white_list"}})],1):e._e(),e._v(" "),r("el-form-item",{attrs:{label:"升级地址",prop:"update_url"}},[r("el-input",{attrs:{placeholder:"请输入版本的升级地址"},model:{value:e.form.update_url,callback:function(t){e.$set(e.form,"update_url",t)},expression:"form.update_url"}})],1),e._v(" "),e.need_upload_app_package?r("el-form-item",{attrs:{label:""}},[r("el-upload",{staticClass:"upload-demo",attrs:{"http-request":e.push_picture_to_cloud,"on-remove":e.remove_picture,multiple:!1,limit:1,"file-list":e.upload_file_list,action:"","list-type":"picture"}},[r("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")])],1)],1):e._e(),e._v(" "),r("span",{staticClass:"group-title"},[e._v("高级策略配置")]),e._v(" "),r("hr",{staticClass:"diviser"}),e._v(" "),r("el-form-item",{attrs:{label:"策略启动条件",prop:"start_strage"}},[r("el-radio",{attrs:{label:"1"},model:{value:e.form.start_strage,callback:function(t){e.$set(e.form,"start_strage",t)},expression:"form.start_strage"}},[e._v("手动启动")])],1),e._v(" "),r("el-form-item",{attrs:{label:"策略停止条件",prop:"end_strage"}},[r("el-radio",{attrs:{label:"1"},model:{value:e.form.end_strage,callback:function(t){e.$set(e.form,"end_strage",t)},expression:"form.end_strage"}},[e._v("手动停止")])],1),e._v(" "),r("el-form-item",{attrs:{label:"自动弹框规则",prop:"is_remind"}},[r("el-radio",{attrs:{label:"1"},model:{value:e.form.is_remind,callback:function(t){e.$set(e.form,"is_remind",t)},expression:"form.is_remind"}},[e._v("不限制(非强制升级用户可忽略弹窗)")])],1),e._v(" "),r("span",{staticClass:"group-title"},[e._v("其它")]),e._v(" "),r("hr",{staticClass:"diviser"}),e._v(" "),r("el-form-item",{attrs:{label:"升级说明",prop:"update_desc"}},[r("el-input",{attrs:{type:"textarea",rows:"4",placeholder:"升级说明",resize:"none"},model:{value:e.form.update_desc,callback:function(t){e.$set(e.form,"update_desc",t)},expression:"form.update_desc"}})],1)],1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{size:"mini"},on:{click:e.cancel_dialog}},[e._v("取 消")]),e._v(" "),r("gl-button",{attrs:{disabled:e.is_busy,pid:"10016,10029",type:"primary",size:"mini"},on:{click:e.create_update_strage}},[e._v(e._s(e.show_save_label))])],1)],1)],1)},[],!1,null,"36419b14",null).exports,m={name:"SyncInstructions",props:{},data:function(){return{platform_version_instructions:o.f,platform_type:"",dialog_visible:!1,is_busy:!1}},computed:{},watch:{},mounted:function(){},methods:{handle_close:function(){var e=this;this.$confirm("确认关闭？").then(function(t){e.dialog_visible=!1,e.platform_type=""}).catch(function(e){})},close_panel:function(){this.dialog_visible=!1,this.platform_type=""},show_panel:function(){this.dialog_visible=!0},make_sure:function(){var e=this;""===this.platform_type?this.$message.warning("发送平台类型不能为空"):this.$confirm("你确定要创建同步版本指令么?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.sync_command_to_remote()}).catch(function(){e.$message({type:"info",message:"同步失败!"})})},sync_command_to_remote:function(){var e=this,t={platform:this.platform_type};this.is_busy=!0,Object(u.fc)(t).then(function(t){0===t.status?(e.dialog_visible=!1,e.$message.success(t.message)):e.$message.error(t.message)}).finally(function(){e.is_busy=!1})}}},f=(r("OkP0"),Object(d.a)(m,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"component-card"},[r("el-dialog",{attrs:{"before-close":e.handle_close,visible:e.dialog_visible,title:"发送同步版本指令",width:"40%",top:"30vh"},on:{"update:visible":function(t){e.dialog_visible=t}}},[r("span",{staticClass:"platform-group-title"},[e._v("发送平台类型")]),e._v(" "),r("hr",{staticClass:"diviser"}),e._v(" "),r("div",{staticClass:"platform-group"},[r("el-row",{attrs:{gutter:"24"}},e._l(e.platform_version_instructions,function(t,a){return r("el-col",{key:a,attrs:{xs:6,sm:6,md:6,lg:6,xl:6}},[r("el-radio",{staticClass:"multi-radio-col",attrs:{label:t.value},model:{value:e.platform_type,callback:function(t){e.platform_type=t},expression:"platform_type"}},[e._v(e._s(t.label)+"\n          ")])],1)}),1)],1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{size:"mini"},on:{click:e.close_panel}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{disabled:e.is_busy,size:"mini",type:"primary"},on:{click:e.make_sure}},[e._v("确 定")])],1)])],1)},[],!1,null,"32ff68b8",null).exports),g=r("X4fA"),_={components:{versionDialog:p,syncInstructions:f},data:function(){var e=Object(g.a)();return{loading:!1,promotion_status:o.h,platforms:o.g,current_platform_type:"",current_promotion_status:"",version_block:[],total:0,page:1,page_size:e,page_sizes:i.V,show_dialog:!1,is_create:!0,version_id:0}},computed:{},mounted:function(){this.init_page()},methods:{init_page:function(){this.fetch_application_version_list()},search_appllication_versions:function(){this.page=1,this.page_size=Object(g.a)(),this.fetch_application_version_list()},change_promotion_status:function(e){this.search_appllication_versions()},change_promotion_platform:function(e){this.search_appllication_versions()},show_deploy_name:function(e){return-1!==["00","02"].indexOf(e.status)?"启动":"停止"},table_size_change:function(e){this.page_size=e,Object(g.d)(e),this.fetch_application_version_list()},change_current:function(e){this.page=e,this.fetch_application_version_list()},get_config:function(){return{page_no:this.page,page_num:this.page_size,platform:this.current_platform_type,status:this.current_promotion_status}},get_label_from_key_value_sets:function(e,t){var r="";return t.map(function(t){t.value===e&&(r=t.label)}),r},fetch_application_version_list:function(){var e=this,t=this.get_config();this.loading=!0,Object(u.T)(t).then(function(t){0===t.status?(e.version_block=t.data.map(function(t){var r=void 0;r=t.file_size?t.file_size+"MB":"";var a=e.get_label_from_key_value_sets(t.platform,o.g),u=e.get_label_from_key_value_sets(t.status,o.h),l=Object(s.b)(t.publish_time,i.p),c=Object(s.b)(t.stop_time,i.p);return n()({},t,{file_size_label:r,platform_label:a,status_label:u,publish_time_label:l,stop_time_label:c})}),e.total=t.total_count):e.$message.error(t.msg)}).finally(function(){e.loading=!1})},destory:function(e){e&&this.fetch_application_version_list(),this.show_dialog=!1},edit_app_version:function(e){this.show_dialog=!0,this.is_create=!1,this.record_id=e.version_id},prefer_deploy:function(e){var t=this,r=void 0;r="02"===("01"===e.status?"02":(e.status,"01"))?"确认是否停止本次应用升级？":"确认是否启动本次应用升级？",this.$confirm(r,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.prefer_deploy_action(e)}).catch(function(){t.$message({type:"info",message:"已取消操作!"})})},prefer_deploy_action:function(e){var t=this,r={status:"01"===e.status?"02":(e.status,"01"),version_id:e.version_id};Object(u.t)(r).then(function(e){0===e.status?t.fetch_application_version_list():t.$message.error(e.message)})},create_app_version:function(e){this.show_dialog=!0,this.is_create=!0,this.record_id=""},sync_version:function(){this.$refs.sync_panel.show_panel()}}},b=(r("OvEM"),Object(d.a)(_,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"content"},[r("div",{staticClass:"search-area"},[r("el-row",{staticClass:"row-bg",attrs:{gutter:10}},[r("el-col",{staticClass:"col-bg",attrs:{xs:12,sm:8,md:6,lg:6,xl:4}},[r("div",{staticClass:"grid-content bg-purple"},[r("el-row",[r("el-col",{staticClass:"order-number-list",attrs:{span:8}},[e._v("状态:")]),e._v(" "),r("el-col",{attrs:{span:16}},[r("el-select",{attrs:{size:"mini",placeholder:"请选择状态",clearable:""},on:{change:e.change_promotion_status},model:{value:e.current_promotion_status,callback:function(t){e.current_promotion_status=t},expression:"current_promotion_status"}},e._l(e.promotion_status,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1)],1)]),e._v(" "),r("el-col",{staticClass:"col-bg",attrs:{xs:12,sm:8,md:6,lg:6,xl:4}},[r("div",{staticClass:"grid-content bg-purple-light"},[r("el-row",[r("el-col",{staticClass:"order-number-list",attrs:{span:8}},[e._v("平台:")]),e._v(" "),r("el-col",{attrs:{span:16}},[r("el-select",{attrs:{size:"mini",placeholder:"请选择平台",clearable:""},on:{change:e.change_promotion_platform},model:{value:e.current_platform_type,callback:function(t){e.current_platform_type=t},expression:"current_platform_type"}},e._l(e.platforms,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1)],1)]),e._v(" "),r("el-col",{staticClass:"col-bg layout-right col-right-button",attrs:{xs:24,sm:8,md:12,lg:12,xl:16}},[r("div",{staticClass:"grid-content bg-purple-light"},[r("el-row",[r("gl-button",{attrs:{pid:"20048",type:"success",size:"mini"},on:{click:e.sync_version}},[e._v("发送同步版本指令\n            ")]),e._v(" "),r("gl-button",{attrs:{pid:"20049",type:"success",size:"mini"},on:{click:e.create_app_version}},[e._v("创建应用升级策略\n            ")])],1)],1)])],1)],1),e._v(" "),r("div",{staticClass:"content-body"},[r("div",{staticClass:"table-block"},[r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.version_block,size:"mini",stripe:""}},[r("el-table-column",{attrs:{label:"目标版本号",prop:"version"}}),e._v(" "),r("el-table-column",{attrs:{label:"升级策略名称",prop:"update_title"}}),e._v(" "),r("el-table-column",{attrs:{label:"包大小",prop:"file_size_label",width:"180"}}),e._v(" "),r("el-table-column",{attrs:{label:"平台",prop:"platform_label",width:"180"}}),e._v(" "),r("el-table-column",{attrs:{label:"启动时间",prop:"publish_time_label",width:"180"}}),e._v(" "),r("el-table-column",{attrs:{label:"停止时间",prop:"stop_time_label",width:"180"}}),e._v(" "),r("el-table-column",{attrs:{label:"状态",prop:"status_label",width:"180"}}),e._v(" "),r("el-table-column",{attrs:{label:"操作",prop:"control",width:"260"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("gl-button",{attrs:{pid:"20050",size:"small",type:"text"},on:{click:function(r){return e.edit_app_version(t.row)}}},[e._v("编辑")]),e._v(" "),r("gl-button",{attrs:{pid:"20051",size:"small",type:"text"},on:{click:function(r){return e.prefer_deploy(t.row)}}},[e._v(e._s(e.show_deploy_name(t.row))+"\n            ")])]}}])})],1),e._v(" "),r("el-pagination",{attrs:{"current-page":e.page,"page-size":e.page_size,"page-sizes":e.page_sizes,total:e.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"current-change":e.change_current,"size-change":e.table_size_change}})],1)]),e._v(" "),e.show_dialog?r("version-dialog",{attrs:{"show-dialog":e.show_dialog,"is-new":e.is_create,rid:e.record_id},on:{destory:e.destory}}):e._e(),e._v(" "),r("sync-instructions",{ref:"sync_panel"})],1)},[],!1,null,"5ae614b9",null));t.default=b.exports},Zkmf:function(e,t,r){"use strict";r.d(t,"a",function(){return m}),r.d(t,"b",function(){return f});var a,n,o=r("14Xm"),u=r.n(o),i=r("D3Ub"),l=r.n(i),s=r("+bwJ"),c=r("vDqi"),d=r.n(c),p=r("z0WU"),m=(a=l()(u.a.mark(function e(t){var r,a,n,o,i,l;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(p.a)(t);case 2:return r=e.sent,a={hash:r},n={headers:{"Content-Type":"application/json"},baseURL:"/gelei-guard-bms/api"},o="/file/data/secondpass",i=Object(s.a)(a),l=JSON.parse(i),e.next=10,d.a.post(o,l,n);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}},e,this)})),function(e){return a.apply(this,arguments)}),f=(n=l()(u.a.mark(function e(t){var r,a,n,o,i,l,c,m;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new FormData).append("file",t),e.next=4,Object(p.a)(t);case 4:for(m in a=e.sent,n={hash:a},o={headers:{"Content-Type":"multipart/form-data"},baseURL:"/gelei-guard-bms/api"},i=Object(s.a)(n),l="/file/data/upload",c=JSON.parse(i))r.append(m,c[m]);return e.next=13,d.a.post(l,r,o);case 13:return e.abrupt("return",e.sent);case 14:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})},ilBh:function(e,t,r){},iyha:function(e,t,r){},kkwS:function(e,t,r){"use strict";var a=r("iyha");r.n(a).a}}]);