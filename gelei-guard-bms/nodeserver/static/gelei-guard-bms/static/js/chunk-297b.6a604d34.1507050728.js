(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-297b"],{RMMT:function(e,t,a){"use strict";var s=a("kpFa");a.n(s).a},Yahv:function(e,t,a){"use strict";a.r(t);var s=a("Zkmf"),r=a("fe1z"),i=a("z0WU"),l=a("YP4+"),n={name:"Profile",components:{},data:function(){var e=this.$store.getters.avatar,t=void 0;t=e?[{url:e,name:"avatar.png"}]:[];var a=Object(i.o)(this.$store.getters.account_type,l.a,l.a[0].label);return{form:{user_id:this.$store.getters.name,real_name:this.$store.getters.real_name,role_name:this.$store.getters.role_name,email:this.$store.getters.email,account_name:a,img_url:this.$store.getters.avatar},rules:{img_url:[{type:"string",required:!0,message:"请按规则上传一张个人图片",trigger:"change"}]},file_list:t,upload_disabled:!1}},watch:{file_list:{handler:function(e){e.length>=1?(this.upload_disabled=!0,this.img_url=e[0].url):this.upload_disabled=!1},immediate:!0}},mounted:function(){},methods:{save:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.save_user_avatar()})},save_user_avatar:function(){var e=this,t={img_url:this.form.img_url};Object(r.f)(t).then(function(t){0===t.status?(e.$message.success(t.message),e.$store.dispatch("GetInfo")):e.$message.error(t.message)})},delete_avatar:function(){this.form.img_url="",this.remove_picture()},remove_picture:function(){this.file_list=[]},push_picture_to_cloud:function(e){var t=this;if(this.file_list.length>=1)this.$message.warning("只能上传一张图片");else{var a=e.file;Object(s.a)(a).then(function(r){var i=r.data;if(-1!==[1,-2,"-2"].indexOf(i.status))Object(s.b)(a).then(function(a){var s=a.data;if(0===s.status){var r=s.data.url,i={name:e.file.name,url:r};t.file_list.push(i),t.form.img_url=r}else t.$message.error(s.message)});else if(-1===i.status)t.$message.error(i.message);else if(0===i.status){var l=i.data.url,n={name:e.file.name,url:l};t.file_list.push(n),t.form.img_url=l,t.$message.success("上传成功")}else t.$message.error(i.message)})}}}},o=(a("RMMT"),a("KHd+")),u=Object(o.a)(n,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"resume"},[a("el-card",{staticClass:"title"},[a("span",[e._v("个人信息")])]),e._v(" "),a("el-card",{staticClass:"box-card"},[a("el-form",{ref:"form",staticClass:"demo-ruleForm",attrs:{model:e.form,rules:e.rules,size:"small","label-width":"100px","label-suffix":":"}},[a("el-form-item",{attrs:{label:"账号名称",prop:"user_id"}},[a("el-input",{attrs:{disabled:""},model:{value:e.form.user_id,callback:function(t){e.$set(e.form,"user_id",t)},expression:"form.user_id"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"真实姓名",prop:"real_name"}},[a("el-input",{attrs:{disabled:""},model:{value:e.form.real_name,callback:function(t){e.$set(e.form,"real_name",t)},expression:"form.real_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"账号类型",prop:"account_name"}},[a("el-input",{attrs:{disabled:""},model:{value:e.form.account_name,callback:function(t){e.$set(e.form,"account_name",t)},expression:"form.account_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"账号角色",prop:"role_name"}},[a("el-input",{attrs:{disabled:""},model:{value:e.form.role_name,callback:function(t){e.$set(e.form,"role_name",t)},expression:"form.role_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"账号邮箱",prop:"email"}},[a("el-input",{attrs:{disabled:""},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"个人头像",prop:"img_url"}},[a("el-upload",{directives:[{name:"show",rawName:"v-show",value:!e.upload_disabled,expression:"!upload_disabled"}],class:{"hidden-img":e.upload_disabled},attrs:{"http-request":e.push_picture_to_cloud,"on-remove":e.remove_picture,multiple:!1,limit:1,"file-list":e.file_list,"show-file-list":!1,action:"",accept:"image/png, image/jpeg","list-type":"picture"}},[a("template",{slot:"tip"},[a("div",{staticClass:"upload-file-to-server"},[e._v("备注: 支持上传jpg/png图片格式, 尺寸为50x50，且不超过100kb.")])]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"primary"}},[e._v("点击上传")])],2),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.upload_disabled,expression:"upload_disabled"}],staticClass:"avatar-area"},[a("img",{staticClass:"avatar",attrs:{src:e.form.img_url,alt:""}}),e._v(" "),a("i",{staticClass:"el-icon-delete avatar-delete",on:{click:e.delete_avatar}})])],1),e._v(" "),a("el-form-item",{staticClass:"update-action"},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.save("form")}}},[e._v("保存")])],1)],1)],1)],1)},[],!1,null,"912ffa96",null);t.default=u.exports},Zkmf:function(e,t,a){"use strict";a.d(t,"a",function(){return p}),a.d(t,"b",function(){return d});var s,r,i=a("14Xm"),l=a.n(i),n=a("D3Ub"),o=a.n(n),u=a("+bwJ"),m=a("vDqi"),c=a.n(m),f=a("z0WU"),p=(s=o()(l.a.mark(function e(t){var a,s,r,i,n,o;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(f.a)(t);case 2:return a=e.sent,s={hash:a},r={headers:{"Content-Type":"application/json"},baseURL:"/gelei-guard-bms/api"},i="/file/data/secondpass",n=Object(u.a)(s),o=JSON.parse(n),e.next=10,c.a.post(i,o,r);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}},e,this)})),function(e){return s.apply(this,arguments)}),d=(r=o()(l.a.mark(function e(t){var a,s,r,i,n,o,m,p;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(a=new FormData).append("file",t),e.next=4,Object(f.a)(t);case 4:for(p in s=e.sent,r={hash:s},i={headers:{"Content-Type":"multipart/form-data"},baseURL:"/gelei-guard-bms/api"},n=Object(u.a)(r),o="/file/data/upload",m=JSON.parse(n))a.append(p,m[p]);return e.next=13,c.a.post(o,a,i);case 13:return e.abrupt("return",e.sent);case 14:case"end":return e.stop()}},e,this)})),function(e){return r.apply(this,arguments)})},kpFa:function(e,t,a){}}]);