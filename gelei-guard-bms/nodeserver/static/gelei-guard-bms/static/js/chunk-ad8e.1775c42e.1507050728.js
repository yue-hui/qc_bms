(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-ad8e"],{"6CbA":function(e,t,i){"use strict";var s=i("ifnG");i.n(s).a},"8r5B":function(e,t,i){},"9iEX":function(e,t,i){"use strict";var s=i("VmEm");i.n(s).a},VmEm:function(e,t,i){},X644:function(e,t,i){"use strict";i.r(t);var s=i("4d7F"),r=i.n(s),a=i("14Xm"),n=i.n(a),o=i("D3Ub"),l=i.n(o),c=i("QbLZ"),_=i.n(c),d=i("glbJ"),m=i("L2JU"),u=i("bja8"),f=i("YP4+"),p=i("z0WU"),v={name:"WorkOrdersDetails",components:{Tinymce:d.a},data:function(){return{page_loading:!0,page_header_content:"创建工单",action:this.$route.query.action,ticket_id:this.$route.query.ticket_id,submit_loading:!1,reminder_work_order_loading:!1,save_work_order_loading:!1,assigned_work_order_loading:!1,close_work_order_loading:!1,reuse_work_order_loading:!1,submit_transfer_work_order_loading:!1,submit_comment_order_loading:!1,history_record_loading:!1,work_order_titles:[],device_type_list:[],terminal_types:f.W,ticket_types:[],ticket_type_disabled:!0,question_types:[],question_type_disabled:!0,question_detail_types:[],question_detail_disabled:!0,urgency_degrees:f.X,comment_and_copy_users:[],comment_users:[],comment:"",patriarch_info:{},communication_methods:f.i,communication_method:"微信/QQ/邮箱",current_child:{},child_device_list:[],current_device:{},handler_users:[],current_work_orders_status:"",work_orders_status:f.Z,work_orders_state:"",work_orders_question_classifies:f.Y,forms:{ticket_title:"",ticket_no:"",device_type:"",ticket_type_id:"",question_type_id:"",question_detail_id:"",degree:"",ticket_source:"",ticket_source_details:"",p_phone:"",p_user_id:"",c_user_id:"",c_device_id:"",assigned_ao_id:"",problem_description:""},forms_rules:{ticket_title:[{type:"string",required:!0,message:"工单标题不能为空",trigger:"blur"}],device_type:[{type:"string",required:!0,message:"请选择终端类型",trigger:"blur"}],ticket_type_id:[{type:"string",required:!0,message:"请选择工单类别",trigger:"blur"}],question_type_id:[{type:"string",required:!0,message:"请选择问题分类",trigger:"blur"}],question_detail_id:[{type:"string",required:!0,message:"请选择问题细分",trigger:"blur"}],degree:[{type:"string",required:!0,message:"请选择工单紧急程度",trigger:"blur"}],ticket_source:[{type:"string",required:!0,message:"请选择工单来源",trigger:"blur"}],ticket_source_details:[{type:"string",required:!0,message:"请输入微信/QQ/邮箱",trigger:"blur"}]},work_order_detail_rules:{problem_description:[{type:"string",required:!0,message:"请输入填写问题描述",trigger:"blur"}],assigned_ao_id:[{type:"string",required:!0,message:"请输入选择处理人",trigger:"blur"}]},detail_active:"1",ticket_comments:[],ticket_change_records:[],histories:[],transfer_visible:!1,transfer_form_loading:!1,tranfer_users:[],transfer_form:{after_user_id:"",remark:""},transfer_rules:{after_user_id:[{type:"string",required:!0,message:"请选择转交人",trigger:"blur"}],remark:[{type:"string",required:!0,message:"请填写备注信息",trigger:"blur"}]},comment_visible:!1,comment_form:{comment:"",cc_users:[]},comment_rules:{comment:[{type:"string",required:!0,message:"请填写评论",trigger:"blur"}],cc_users:[{type:"string",required:!0,message:"请选择抄送人",trigger:"blur"}]},assigned_forms:{state:"",problem_type:"",comment:""},assigned_rules:{state:[{type:"string",required:!0,message:"请选择工单状态",trigger:"blur"},{required:!0,trigger:"blur",validator:function(e,t,i){"1"!==t?i(new Error("工单状态需为“已处理”才可提交")):i()}}],problem_type:[{type:"string",required:!0,message:"需选择工单“问题归类”才可提交",trigger:"blur"}],comment:[{type:"string",required:!0,message:"需对工单进行“处理结果评论”才可提交",trigger:"blur"}]}}},computed:_()({},Object(m.b)(["name","real_name","role_name"]),{identity:function(){return this.name===this.forms.applicant_id?"01":this.name===this.forms.assigned_ao_id?"02":-1!==this.comment_and_copy_users.map(function(e){return e.value}).indexOf(this.name)?"03":"04"},work_order_state:function(){return this.forms.state}}),mounted:function(){var e=l()(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("1"===this.action&&this.fetch_terminal_types(),-1===["2","3"].indexOf(this.action)){e.next=4;break}return e.next=4,this.fetch_ticket_info();case 4:if(-1===["2"].indexOf(this.action)&&("01"!==this.identity||-1===["3","4"].indexOf(this.work_order_state))){e.next=13;break}return e.next=7,this.fetch_terminal_types(!1);case 7:return e.next=9,this.change_terminal_type(!1);case 9:return e.next=11,this.change_ticket_type(!1);case 11:return e.next=13,this.change_question_types(!1);case 13:-1!==["3"].indexOf(this.action)&&this.fetch_work_order_change_records(),-1!==["1","2","3"].indexOf(this.action)&&(this.fetch_acceptors(),this.fetch_comment_users()),-1!==["2","3"].indexOf(this.action)&&(this.fetch_ticket_associated_histories(),this.fetch_work_order_comments()),this.page_loading=!1;case 17:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),methods:{get_form_data:function(){return{applicant_id:this.name,ticket_title:this.forms.ticket_title,device_type:this.forms.device_type,ticket_type_id:this.forms.ticket_type_id,question_type_id:this.forms.question_type_id,question_detail_id:this.forms.question_detail_id,degree:this.forms.degree,ticket_source:this.forms.ticket_source,ticket_source_details:this.forms.ticket_source_details,p_user_id:this.forms.p_user_id,c_user_id:this.forms.c_user_id,c_device_id:this.forms.c_device_id,problem_description:this.forms.problem_description,assigned_ao_id:this.forms.assigned_ao_id}},validate_element_sets:function(e){var t=this;return new r.a(function(i){t.$refs[e].validate(function(e){i(e)})})},submit:function(){var e=this;this.submit_loading=!0;var t=this.get_form_data();Object(u.c)(Object(p.q)(t)).then(function(t){0===t.status?(e.$message.success("工单添加成功"),window.close()):e.$message.error(t.message)}).finally(function(){e.submit_loading=!1})},submit_with_comfirm:function(){var e=l()(n.a.mark(function e(){var t,i,s=this;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.validate_element_sets("work_order_info");case 2:return t=e.sent,e.next=5,this.validate_element_sets("work_order_detail");case 5:i=e.sent,t&&i&&this.$confirm("确认提交工单么？请确保提供工单信息准确","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){s.submit()});case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),get_edit_form_data:function(){return{ticket_id:this.ticket_id,ticket_title:this.forms.ticket_title,device_type:this.forms.device_type,ticket_type_id:this.forms.ticket_type_id,question_type_id:this.forms.question_type_id,question_detail_id:this.forms.question_detail_id,degree:this.forms.degree,ticket_source:this.forms.ticket_source,ticket_source_details:this.forms.ticket_source_details,problem_description:this.forms.problem_description,assigned_ao_id:this.forms.assigned_ao_id}},save_work_order:function(){var e=l()(n.a.mark(function e(){var t,i,s,r=this;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.validate_element_sets("work_order_info");case 2:return t=e.sent,e.next=5,this.validate_element_sets("work_order_detail");case 5:i=e.sent,t&&i&&(this.save_work_order_loading=!0,s=this.get_edit_form_data(),this.update_work_order_info_or_action(s).then(function(e){0===e.status?window.close():r.$message.error(e.message)}).finally(function(){r.save_work_order_loading=!1}));case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),assigned_work_order:function(){var e=this;this.$refs.assigned_forms.validate(function(t){if(t){e.assigned_work_order_loading=!0;var i={ticket_id:e.forms.ticket_id,state:e.assigned_forms.state,problem_type:e.assigned_forms.problem_type,comment:e.assigned_forms.comment};Object(u.q)(Object(p.q)(i)).then(function(t){0===t.status?window.close():e.$message.error(t.message)}).finally(function(){e.assigned_work_order_loading=!1})}})},reminder_work_order:function(){var e=this;this.reminder_work_order_loading=!0;var t=this.get_edit_form_data();t.msg_type="06",this.update_work_order_info_or_action(t).then(function(t){0===t.status?window.close():e.$message.error(t.message)}).finally(function(){e.reminder_work_order_loading=!1})},reminder_work_order_comfirm:function(){var e=this;this.$confirm("确认关闭此工单么？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.close_work_order()})},close_work_order:function(){var e=this,t=this.get_edit_form_data();t.state="2",this.close_work_order_loading=!0,this.update_work_order_info_or_action(t).then(function(t){0===t.status?window.close():e.$message.error(t.message)}).finally(function(){e.close_work_order_loading=!1})},reuse_work_order_comfirm:function(){var e=this;this.$confirm("确认需求重新打开工单么？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.reuse_work_order()})},reuse_work_order:function(){var e=this,t=this.get_edit_form_data();t.state="4",this.reuse_work_order_loading=!0,this.update_work_order_info_or_action(t).then(function(t){0===t.status?window.location.reload():e.$message.error(t.message)}).finally(function(){e.reuse_work_order_loading=!1})},update_work_order_info_or_action:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new r.a(function(t,i){Object(u.r)(Object(p.q)(e)).then(function(e){t(e)}).catch(function(e){i(e)})})},submit_transfer_form:function(){var e=this;this.$refs.transfer_form.validate(function(t){if(t){var i={ticket_id:e.ticket_id,after_user_id:e.transfer_form.after_user_id,remark:e.transfer_form.remark};e.submit_transfer_work_order_loading=!0,Object(u.p)(Object(p.q)(i)).then(function(t){0===t.status?(e.close_transfer_dialog(),window.close()):e.$message.error(t.message)}).finally(function(){e.submit_transfer_work_order_loading=!1})}})},transfer_work_order_action:function(){this.transfer_visible=!0,this.fetch_tranfer_user()},before_close_transfer:function(){var e=this;this.$confirm("确认是否转交窗口？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.close_transfer_dialog()})},close_transfer_dialog:function(){this.transfer_visible=!1,this.transfer_form.after_user_id="",this.transfer_form.remark=""},select_work_order_source:function(){var e=this,t=f.i.find(function(t){return t.value===e.forms.ticket_source});this.communication_method=t.label},jump_to_history_page:function(e){var t={action:"3",ticket_id:e},i=this.$router.resolve({name:"WorkOrdersSystemDetails",query:t});window.open(i.href,"_blank","scrollbars=yes,resizable=1,modal=false,alwaysRaised=yes")},get_bind_type_name:function(e){return"1"===e?"绑定中":"0"===e?"已解绑":""},get_child_device_list:function(e){var t=this;return e.map(function(e){var i=Object(p.b)(e.c_bind_time,f.p),s=Object(p.b)(e.c_unbind_time,f.p),r=t.get_bind_type_name(e.c_bind_type);return _()({},e,{c_bind_time:i,c_unbind_time:s,c_bind_type:r})})},change_child:function(e){var t=this.patriarch_info.chlid_list.find(function(t){return t.c_user_id===e});if(this.current_child=t||{},this.current_child.c_user_id){this.forms.c_user_id=this.current_child.c_user_id;var i=t.c_device_list||[];this.child_device_list=this.get_child_device_list(i),this.child_device_list.length?(this.current_device=this.child_device_list[0],this.forms.c_device_id=this.child_device_list[0].c_device_id):(this.current_device={},this.forms.c_device_id="")}else this.forms.c_user_id="",this.forms.c_device_id="",this.child_device_list=[]},change_child_device:function(e){var t=this.child_device_list.find(function(t){return t.c_device_id===e});this.current_device=t||{},this.forms.c_device_id=this.current_device.c_device_id},patriarch_phone_change:function(){var e=this,t=this.forms.p_phone;if(t&&11===t.length){var i={phone:t};Object(u.k)(i).then(function(t){if(0===t.status)if(e.patriarch_info=t.data,t.data.p_user_id){e.patriarch_info.p_create_time=Object(p.b)(e.patriarch_info.p_create_time,f.p),e.patriarch_info.p_member_type_label=Object(p.o)(e.patriarch_info.p_member_type,f.J);var i=e.patriarch_info.c_user_list.map(function(e){var t=Object(p.b)(e.c_create_time,f.p);return _()({},e,{c_create_time:t})});if(e.forms.p_user_id=e.patriarch_info.p_user_id,e.patriarch_info.chlid_list=i||[],i&&0!==i.length){var s=i[0];e.current_child=s,e.forms.c_user_id=e.current_child.c_user_id,e.child_device_list=e.get_child_device_list(s.c_device_list||[]),e.child_device_list&&e.child_device_list.length?(e.current_device=e.child_device_list[0],e.$nextTick(function(){e.forms.c_device_id=e.child_device_list[0].c_device_id})):(e.forms.c_device_id="",e.current_device={},e.child_device_list=[])}else e.current_child={},e.forms.c_user_id="",e.current_device={},e.child_device_list=[],e.forms.c_device_id=""}else e.patriarch_info={},e.forms.p_user_id="",e.current_child={},e.forms.c_user_id="",e.current_device={},e.child_device_list=[],e.forms.c_device_id="";else e.patriarch_info={},e.forms.p_user_id="",e.current_child={},e.forms.c_user_id="",e.current_device={},e.child_device_list=[],e.forms.c_device_id="",e.$message.error(t.message)}),this.fetch_ticket_associated_histories()}else this.patriarch_info={},this.forms.p_user_id="",this.current_child={},this.forms.c_user_id="",this.current_device={},this.child_device_list=[],this.forms.c_device_id=""},change_question_types:function(){var e=l()(n.a.mark(function e(){var t,i=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.forms.question_type_id,e.next=3,this.fetch_ticket_label_types(t);case 3:this.question_detail_types=e.sent,this.question_detail_disabled=!1,i&&(this.forms.question_detail_id="");case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),change_ticket_type:function(){var e=l()(n.a.mark(function e(){var t,i=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.forms.ticket_type_id,e.next=3,this.fetch_ticket_label_types(t);case 3:this.question_types=e.sent,this.question_type_disabled=!1,this.question_detail_disabled=!0,i&&(this.forms.question_type_id="",this.forms.question_detail_id="",this.question_detail_types=[]);case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),change_terminal_type:function(){var e=l()(n.a.mark(function e(){var t,i=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.forms.device_type,e.next=3,this.fetch_ticket_label_types(t);case 3:this.ticket_types=e.sent,this.ticket_type_disabled=!1,this.question_type_disabled=!0,this.question_detail_disabled=!0,i&&(this.forms.ticket_type_id="",this.forms.question_type_id="",this.forms.question_detail_id="",this.question_types=[],this.question_detail_types=[]);case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),fetch_terminal_types:function(){var e=l()(n.a.mark(function e(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetch_ticket_label_types();case 2:this.terminal_types=e.sent,this.ticket_type_disabled=!0,this.question_type_disabled=!0,this.question_detail_disabled=!0,t&&(this.forms.ticket_type_id="",this.forms.question_type_id="",this.forms.question_detail_id="",this.ticket_types=[],this.question_types=[],this.question_detail_types=[]);case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),fetch_ticket_label_types:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new r.a(function(t){var i={type_id:e};Object(u.f)(Object(p.q)(i)).then(function(e){if(0===e.status){var i=e.data.map(function(e){return _()({},e,{value:e.id+"",label:e.type_name})});t(i)}})})},fetch_work_order_titles:function(e,t){var i=this;if(e){var s={ticket_title:e};Object(u.j)(Object(p.q)(s)).then(function(e){if(0===e.status){var s=e.data;i.work_order_titles=s;var r=s.map(function(e){return{value:e}});t(r)}})}},fetch_acceptors:function(){var e=l()(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetch_users_by_associated_type("01");case 2:this.handler_users=e.sent;case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),fetch_comment_users:function(){var e=l()(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetch_users_by_associated_type("02");case 2:this.comment_and_copy_users=e.sent;case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),fetch_tranfer_user:function(){var e=l()(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.transfer_form_loading=!0,e.next=3,this.fetch_users_by_associated_type("03");case 3:this.tranfer_users=e.sent,this.transfer_form_loading=!1;case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),fetch_users_by_associated_type:function(e){var t=this;return new r.a(function(i){var s={associated_type:e,ticket_id:t.ticket_id};Object(u.n)(Object(p.q)(s)).then(function(e){if(0===e.status){var t=e.data.map(function(e){return _()({},e,{value:e.user_id,label:e.real_name})});i(t)}else i([])}).catch(function(){i([])})})},fetch_ticket_info:function(){var e=this;return new r.a(function(t,i){var s={ticket_id:e.ticket_id};Object(u.l)(Object(p.q)(s)).then(function(i){if(0===i.status){var s=i.data;s.c_bind_type=e.get_bind_type_name(s.c_bind_type),s.p_member_type_label=Object(p.o)(s.p_member_type,f.J),s.problem_type_label=Object(p.o)(s.problem_type,e.work_orders_question_classifies,""),s.degree_label=Object(p.o)(s.degree,f.ab),s.ticket_source_label=Object(p.o)(s.ticket_source,e.communication_methods,"微信/QQ/邮箱"),e.communication_method=s.ticket_source_label||e.communication_methods[0].label;var r=e.work_orders_status.find(function(e){return"3"===e.value});s.state_label=Object(p.o)(s.state,e.work_orders_status,r.label),e.forms=s,t(s)}else t({}),e.$message.error(i.message)}).catch(function(e){i(e)})})},fetch_work_order_comments:function(){var e=this,t={ticket_id:this.ticket_id};Object(u.o)(Object(p.q)(t)).then(function(t){0===t.status?e.ticket_comments=t.data:(e.$message.error(t.message),e.ticket_comments=[])})},fetch_work_order_change_records:function(){var e=this,t={ticket_id:this.ticket_id};this.history_record_loading=!0,Object(u.i)(Object(p.q)(t)).then(function(t){0===t.status?e.ticket_change_records=t.data:(e.ticket_change_records=[],e.$message.error(t.message))}).finally(function(){e.history_record_loading=!1})},fetch_ticket_associated_histories:function(){var e=this,t={phone:this.forms.p_phone};Object(u.h)(Object(p.q)(t)).then(function(t){0===t.status?e.histories=t.data:(e.histories=[],e.$message.error(t.message))})},add_comment:function(){this.comment_visible=!0},before_close_comment:function(){var e=this;this.$confirm("确认是否评论窗口？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.close_comment_dialog()})},close_comment_dialog:function(){this.comment_visible=!1,this.comment_form={cc_users:[],comment:""},this.$refs.tinymce_comment.setContent("")},submit_comment:function(){var e=this;this.$refs.comment_form.validate(function(t){if(t){var i={ticket_id:e.ticket_id,user_id:e.name,cc_user_id:e.comment_form.cc_users.join(","),comment:e.comment_form.comment};e.submit_comment_order_loading=!0,Object(u.a)(Object(p.q)(i)).then(function(t){0===t.status?(e.fetch_work_order_comments(),e.close_comment_dialog()):e.$message.error(t.message)}).finally(function(){e.submit_comment_order_loading=!1})}})}}},h=(i("l05Z"),i("KHd+")),b=Object(h.a)(v,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.page_loading,expression:"page_loading"}],staticClass:"work-order-details"},[s("div",{staticClass:"form-diviser mb-20"},[s("div",{staticClass:"form-top-layout"},["1"===e.action?s("span",[e._v("创建工单")]):e._e(),e._v(" "),-1!==["3","2"].indexOf(e.action)?s("span",{staticClass:"work-order-title"},[s("span",{attrs:{title:e.forms.ticket_no}},[e._v("【 "+e._s(e.forms.ticket_no)+" 】")]),e._v(" "),s("span",[e._v(" - ")]),e._v(" "),s("span",{attrs:{title:e.forms.ticket_title}},[e._v(e._s(e._f("beautifyWordsFormatter")(e.forms.ticket_title,30)))])]):e._e(),e._v(" "),s("span",["1"===e.action?s("el-button",{attrs:{loading:e.submit_loading,type:"primary",size:"mini","data-alias":"create"},on:{click:e.submit_with_comfirm}},[e._v("提交")]):e._e(),e._v(" "),"2"===e.action||"01"===e.identity&&-1!==["3","4"].indexOf(e.work_order_state)?s("el-button",{attrs:{loading:e.reminder_work_order_loading,type:"primary",size:"mini"},on:{click:e.reminder_work_order}},[e._v("催单")]):e._e(),e._v(" "),"2"===e.action||"01"===e.identity&&-1!==["3","4"].indexOf(e.work_order_state)?s("el-button",{attrs:{loading:e.save_work_order_loading,type:"primary",size:"mini","data-alias":"create"},on:{click:e.save_work_order}},[e._v("保存")]):e._e(),e._v(" "),"02"===e.identity&&-1!==["3","4"].indexOf(e.work_order_state)?s("el-button",{attrs:{loading:e.assigned_work_order_loading,type:"primary",size:"mini","data-alias":"assigned"},on:{click:e.assigned_work_order}},[e._v("提交")]):e._e(),e._v(" "),"02"===e.identity&&-1!==["3","4"].indexOf(e.work_order_state)?s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.transfer_work_order_action}},[e._v("转交")]):e._e(),e._v(" "),"01"===e.identity&&-1!==["1"].indexOf(e.work_order_state)?s("el-button",{attrs:{loading:e.close_work_order_loading,type:"primary",size:"mini"},on:{click:e.close_work_order}},[e._v("关闭工单")]):e._e(),e._v(" "),"01"===e.identity&&-1!==["2"].indexOf(e.work_order_state)?s("el-button",{attrs:{loading:e.reuse_work_order_loading,type:"primary",size:"mini"},on:{click:e.reuse_work_order_comfirm}},[e._v("重新打开")]):e._e()],1)])]),e._v(" "),s("el-form",{attrs:{size:"mini","label-suffix":":","label-width":"120px","label-position":"left"},nativeOn:{submit:function(e){e.preventDefault()}}},[s("el-row",{staticClass:"form-row",attrs:{gutter:24}},[s("el-col",{attrs:{xs:12,sm:8,md:6,lg:5,xl:4}},[s("div",{staticClass:"grid-content bg-purple"},[s("el-form-item",{attrs:{label:"创建人"}},[-1!==["1","2"].indexOf(e.action)?s("span",{staticClass:"label-text"},[e._v(e._s(e.real_name))]):-1!==["3"].indexOf(e.action)?s("span",{staticClass:"label-text"},[e._v(e._s(e.forms.applicant_name))]):e._e()])],1)]),e._v(" "),s("el-col",{attrs:{xs:12,sm:8,md:6,lg:5,xl:4}},[s("div",{staticClass:"grid-content bg-purple"},[s("el-form-item",{attrs:{label:"申请人角色"}},[-1!==["1","2"].indexOf(e.action)?s("span",{staticClass:"label-text"},[e._v(e._s(e.role_name))]):-1!==["3"].indexOf(e.action)?s("span",{staticClass:"label-text"},[e._v(e._s(e.forms.applicant_role_name))]):e._e()])],1)]),e._v(" "),"3"===e.action?s("el-col",{attrs:{xs:12,sm:8,md:6,lg:5,xl:4}},[s("div",{staticClass:"grid-content bg-purple"},[s("el-form-item",{attrs:{label:"紧急程度"}},[s("span",{staticClass:"label-text"},[e._v(e._s(e.forms.degree_label))])])],1)]):e._e(),e._v(" "),"3"===e.action?s("el-col",{attrs:{xs:12,sm:8,md:6,lg:5,xl:4}},[s("div",{staticClass:"grid-content bg-purple"},[s("el-form-item",{attrs:{label:"处理人"}},[s("span",{staticClass:"label-text"},[e._v(e._s(e.forms.assigned_ao_name))])])],1)]):e._e(),e._v(" "),"3"===e.action?s("el-col",{attrs:{xs:12,sm:8,md:6,lg:5,xl:4}},[s("div",{staticClass:"grid-content bg-purple"},[s("el-form-item",{attrs:{label:"工单状态"}},[s("span",{staticClass:"label-text"},[e._v(e._s(e.forms.state_label))])])],1)]):e._e(),e._v(" "),"3"===e.action?s("el-col",{attrs:{xs:12,sm:8,md:6,lg:5,xl:4}},[s("div",{staticClass:"grid-content bg-purple"},[s("el-form-item",{attrs:{label:"录入时间"}},[s("span",{staticClass:"label-text"},[e._v(e._s(e._f("dateFormatter")(e.forms.create_time,"YYYY-MM-DD HH:mm:ss")))])])],1)]):e._e()],1)],1),e._v(" "),s("div",{staticClass:"form-diviser mb-20"},[e._v("工单信息")]),e._v(" "),s("el-form",{ref:"work_order_info",attrs:{model:e.forms,rules:e.forms_rules,size:"mini","label-suffix":":","label-width":"120px","label-position":"left"},nativeOn:{submit:function(e){e.preventDefault()}}},[s("el-row",{staticClass:"form-row",attrs:{gutter:24}},[s("el-col",{staticClass:"col-bg",attrs:{xs:22,sm:16,md:14,lg:12,xl:8}},[s("div",{staticClass:"grid-content bg-purple"},[s("el-form-item",{attrs:{label:"工单标题",prop:"ticket_title"}},[-1!==["1","2"].indexOf(e.action)||"01"===e.identity&&-1!==["3","4"].indexOf(e.work_order_state)?[s("el-autocomplete",{staticStyle:{width:"100%"},attrs:{"fetch-suggestions":e.fetch_work_order_titles,clearable:"",placeholder:"请选择工单标题"},model:{value:e.forms.ticket_title,callback:function(t){e.$set(e.forms,"ticket_title",t)},expression:"forms.ticket_title"}})]:[s("span",{staticClass:"label-text",attrs:{title:e.forms.ticket_title}},[e._v(e._s(e._f("beautifyWordsFormatter")(e.forms.ticket_title,30)))])]],2)],1)])],1),e._v(" "),s("el-row",{staticClass:"form-row",attrs:{gutter:24}},[s("el-col",{staticClass:"col-bg",attrs:{xs:12,sm:8,md:6,lg:6,xl:6}},[s("div",{staticClass:"grid-content bg-purple"},[s("el-form-item",{attrs:{label:"终端类型",prop:"device_type"}},[-1!==["1","2"].indexOf(e.action)||"01"===e.identity&&-1!==["3","4"].indexOf(e.work_order_state)?[s("el-select",{staticStyle:{width:"100%"},attrs:{size:"mini",placeholder:"请选择终端类型"},on:{change:e.change_terminal_type},model:{value:e.forms.device_type,callback:function(t){e.$set(e.forms,"device_type",t)},expression:"forms.device_type"}},e._l(e.terminal_types,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)]:[s("span",{staticClass:"label-text"},[e._v(e._s(e.forms.device_type_name))])]],2)],1)])],1),e._v(" "),s("el-row",{staticClass:"form-row",attrs:{gutter:24}},[s("el-col",{staticClass:"col-bg",attrs:{xs:12,sm:8,md:6,lg:6,xl:4}},[s("div",{staticClass:"grid-content bg-purple"},[s("el-form-item",{attrs:{label:"工单类别",prop:"ticket_type_id"}},[-1!==["1","2"].indexOf(e.action)||"01"===e.identity&&-1!==["3","4"].indexOf(e.work_order_state)?[s("el-select",{attrs:{disabled:e.ticket_type_disabled,size:"mini",placeholder:"请选择工单类别"},on:{change:e.change_ticket_type},model:{value:e.forms.ticket_type_id,callback:function(t){e.$set(e.forms,"ticket_type_id",t)},expression:"forms.ticket_type_id"}},e._l(e.ticket_types,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)]:[s("span",{staticClass:"label-text"},[e._v(e._s(e.forms.ticket_type_name))])]],2)],1)]),e._v(" "),s("el-col",{staticClass:"col-bg",attrs:{xs:12,sm:8,md:6,lg:6,xl:4}},[s("div",{staticClass:"grid-content bg-purple"},[s("el-form-item",{attrs:{label:"问题分类",prop:"question_type_id"}},[-1!==["1","2"].indexOf(e.action)||"01"===e.identity&&-1!==["3","4"].indexOf(e.work_order_state)?[s("el-select",{attrs:{disabled:e.question_type_disabled,size:"mini",placeholder:"请选择问题分类"},on:{change:e.change_question_types},model:{value:e.forms.question_type_id,callback:function(t){e.$set(e.forms,"question_type_id",t)},expression:"forms.question_type_id"}},e._l(e.question_types,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)]:[s("span",{staticClass:"label-text"},[e._v(e._s(e.forms.question_type_name))])]],2)],1)]),e._v(" "),s("el-col",{staticClass:"col-bg",attrs:{xs:12,sm:8,md:6,lg:6,xl:4}},[s("div",{staticClass:"grid-content bg-purple"},[s("el-form-item",{attrs:{label:"问题细分",prop:"question_detail_id"}},[-1!==["1","2"].indexOf(e.action)||"01"===e.identity&&-1!==["3","4"].indexOf(e.work_order_state)?[s("el-select",{attrs:{disabled:e.question_detail_disabled,size:"mini",placeholder:"请选择问题细分"},model:{value:e.forms.question_detail_id,callback:function(t){e.$set(e.forms,"question_detail_id",t)},expression:"forms.question_detail_id"}},e._l(e.question_detail_types,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)]:[s("span",{staticClass:"label-text"},[e._v(e._s(e.forms.question_detail_name))])]],2)],1)])],1),e._v(" "),s("el-row",{staticClass:"form-row",attrs:{gutter:24}},[s("el-col",{staticClass:"col-bg",attrs:{xs:12,sm:8,md:6,lg:6,xl:4}},[s("div",{staticClass:"grid-content bg-purple"},[s("el-form-item",{attrs:{label:"紧急程度",prop:"degree"}},[-1!==["1","2"].indexOf(e.action)||"01"===e.identity&&-1!==["3","4"].indexOf(e.work_order_state)?[s("el-select",{attrs:{size:"mini",placeholder:"请选择紧急程度"},model:{value:e.forms.degree,callback:function(t){e.$set(e.forms,"degree",t)},expression:"forms.degree"}},e._l(e.urgency_degrees,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)]:[s("span",{staticClass:"label-text"},[e._v(e._s(e.forms.degree_label))])]],2)],1)]),e._v(" "),s("el-col",{staticClass:"col-bg",attrs:{xs:12,sm:8,md:6,lg:6,xl:4}},[s("div",{staticClass:"grid-content bg-purple"},[s("el-form-item",{attrs:{label:"工单来源",prop:"ticket_source"}},[-1!==["1","2"].indexOf(e.action)||"01"===e.identity&&-1!==["3","4"].indexOf(e.work_order_state)?[s("el-select",{attrs:{size:"mini",placeholder:"请选择工单来源",clearable:""},on:{change:e.select_work_order_source},model:{value:e.forms.ticket_source,callback:function(t){e.$set(e.forms,"ticket_source",t)},expression:"forms.ticket_source"}},e._l(e.communication_methods,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)]:[s("span",{staticClass:"label-text"},[e._v(e._s(e.forms.ticket_source_label))])]],2)],1)]),e._v(" "),s("el-col",{staticClass:"col-bg",attrs:{xs:12,sm:8,md:6,lg:6,xl:4}},[s("div",{staticClass:"grid-content bg-purple"},[s("el-form-item",{attrs:{label:e.communication_method,prop:"ticket_source_details"}},[-1!==["1","2"].indexOf(e.action)||"01"===e.identity&&-1!==["3","4"].indexOf(e.work_order_state)?[s("el-input",{attrs:{maxlength:11,placeholder:"请输入"+e.communication_method,size:"mini",clearable:""},model:{value:e.forms.ticket_source_details,callback:function(t){e.$set(e.forms,"ticket_source_details",t)},expression:"forms.ticket_source_details"}})]:[s("span",{staticClass:"label-text"},[e._v(e._s(e.forms.ticket_source_details))])]],2)],1)])],1)],1),e._v(" "),s("div",{staticClass:"form-diviser mt-10 mb-20"},[e._v("家长信息")]),e._v(" "),s("div",{staticClass:"form-row"},[s("el-form",{ref:"work_order_patriarch",attrs:{model:e.forms,rules:e.forms_rules,size:"mini","label-suffix":":","label-width":"120px","label-position":"left"},nativeOn:{submit:function(e){e.preventDefault()}}},[s("el-row",{attrs:{gutter:24}},[s("el-col",{staticClass:"col-bg",attrs:{xs:12,sm:8,md:6,lg:6,xl:4}},[s("div",{staticClass:"grid-content bg-purple"},[s("el-form-item",{attrs:{label:"手机号"}},[-1!==["1"].indexOf(e.action)?s("el-input",{attrs:{maxlength:"11",size:"mini",clearable:"",placeholder:"请输入手机号"},on:{change:e.patriarch_phone_change},nativeOn:{keyup:function(t){e.forms.p_phone=e.forms.p_phone.replace(/[^\d]/g,"")}},model:{value:e.forms.p_phone,callback:function(t){e.$set(e.forms,"p_phone",t)},expression:"forms.p_phone"}}):e._e(),e._v(" "),-1!==["2","3"].indexOf(e.action)?s("span",{staticClass:"label-text"},[e._v(e._s(e.forms.p_phone))]):e._e()],1)],1)]),e._v(" "),s("el-col",{staticClass:"col-bg",attrs:{xs:12,sm:8,md:6,lg:6,xl:4}},[s("div",{staticClass:"grid-content bg-purple"},[s("el-form-item",{attrs:{label:"家长昵称"}},[-1!==["1"].indexOf(e.action)?s("span",{staticClass:"label-text"},[e._v(e._s(e.patriarch_info.p_nick_name))]):e._e(),e._v(" "),-1!==["2","3"].indexOf(e.action)?s("span",{staticClass:"label-text"},[e._v(e._s(e.forms.p_nick_name))]):e._e()])],1)]),e._v(" "),s("el-col",{staticClass:"col-bg",attrs:{xs:12,sm:8,md:6,lg:6,xl:4}},[s("div",{staticClass:"grid-content bg-purple"},[s("el-form-item",{attrs:{label:"终端类型"}},[-1!==["1"].indexOf(e.action)?s("span",{staticClass:"label-text"},[e._v(e._s(e.patriarch_info.p_device_type_label))]):e._e(),e._v(" "),-1!==["2","3"].indexOf(e.action)?s("span",{staticClass:"label-text"},[e._v(e._s(e.forms.p_device_type_label))]):e._e()])],1)]),e._v(" "),s("el-col",{staticClass:"col-bg",attrs:{xs:12,sm:8,md:6,lg:6,xl:4}},[s("div",{staticClass:"grid-content bg-purple"},[s("el-form-item",{attrs:{label:"系统版本号"}},[-1!==["1"].indexOf(e.action)?s("span",{staticClass:"label-text"},[e._v(e._s(e.patriarch_info.p_os_version))]):e._e(),e._v(" "),-1!==["2","3"].indexOf(e.action)?s("span",{staticClass:"label-text"},[e._v(e._s(e.forms.p_os_version))]):e._e()])],1)]),e._v(" "),s("el-col",{staticClass:"col-bg",attrs:{xs:12,sm:8,md:6,lg:6,xl:4}},[s("div",{staticClass:"grid-content bg-purple"},[s("el-form-item",{attrs:{label:"家长端版本号"}},[-1!==["1"].indexOf(e.action)?s("span",{staticClass:"label-text"},[e._v(e._s(e.patriarch_info.p_version))]):e._e(),e._v(" "),-1!==["2","3"].indexOf(e.action)?s("span",{staticClass:"label-text"},[e._v(e._s(e.forms.p_version))]):e._e()])],1)]),e._v(" "),s("el-col",{staticClass:"col-bg",attrs:{xs:12,sm:8,md:6,lg:6,xl:4}},[s("div",{staticClass:"grid-content bg-purple"},[s("el-form-item",{attrs:{label:"注册时间"}},[-1!==["1"].indexOf(e.action)?s("span",{staticClass:"label-text"},[e._v(e._s(e.patriarch_info.p_create_time))]):e._e(),e._v(" "),-1!==["2","3"].indexOf(e.action)?s("span",{staticClass:"label-text"},[e._v(e._s(e._f("dateFormatter")(e.forms.p_create_time,"YYYY-MM-DD HH:mm:ss")))]):e._e()])],1)]),e._v(" "),s("el-col",{staticClass:"col-bg",attrs:{xs:12,sm:8,md:6,lg:6,xl:4}},[s("div",{staticClass:"grid-content bg-purple"},[s("el-form-item",{attrs:{label:"会员类型"}},[-1!==["1"].indexOf(e.action)?s("span",{staticClass:"label-text"},[e._v(e._s(e.patriarch_info.p_member_type_label))]):e._e(),e._v(" "),-1!==["2","3"].indexOf(e.action)?s("span",{staticClass:"label-text"},[e._v(e._s(e.forms.p_member_type_label))]):e._e()])],1)]),e._v(" "),s("el-col",{staticClass:"col-bg",attrs:{xs:12,sm:8,md:6,lg:6,xl:4}},[s("div",{staticClass:"grid-content bg-purple"},[s("el-form-item",{attrs:{label:"会员有效天数"}},[-1!==["1"].indexOf(e.action)?s("span",{staticClass:"label-text"},[e._v(e._s(e.patriarch_info.p_valid_days)+" 天")]):e._e(),e._v(" "),-1!==["2","3"].indexOf(e.action)?s("span",{staticClass:"label-text"},[e._v(e._s(e.forms.p_valid_days)+" 天")]):e._e()])],1)]),e._v(" "),s("el-col",{staticClass:"col-bg",attrs:{xs:12,sm:8,md:6,lg:6,xl:4}},[s("div",{staticClass:"grid-content bg-purple"},[s("el-form-item",{attrs:{label:"用户来源"}},[-1!==["1"].indexOf(e.action)?s("span",{staticClass:"label-text"},[e._v(e._s(e.patriarch_info.p_reg_from_label))]):e._e(),e._v(" "),-1!==["2","3"].indexOf(e.action)?s("span",{staticClass:"label-text"},[e._v(e._s(e.forms.p_reg_from_label))]):e._e()])],1)]),e._v(" "),s("el-col",{staticClass:"col-bg",attrs:{xs:12,sm:8,md:6,lg:6,xl:4}},[s("div",{staticClass:"grid-content bg-purple"},[s("el-form-item",{attrs:{label:"最近使用时间"}},[-1!==["1"].indexOf(e.action)?s("span",{staticClass:"label-text"},[e._v(e._s(e.patriarch_info.last_use_time))]):e._e(),e._v(" "),-1!==["2","3"].indexOf(e.action)?s("span",{staticClass:"label-text"},[e._v(e._s(e.forms.last_use_time))]):e._e()])],1)])],1)],1)],1),e._v(" "),s("div",{staticClass:"form-diviser mt-10 mb-20"},[-1!==["1"].indexOf(e.action)?s("el-dropdown",{on:{command:e.change_child}},[s("span",{staticClass:"el-dropdown-link"},[e._v("\n        孩子 "+e._s(e.current_child.c_nick_name)+" "),s("i",{staticClass:"el-icon-arrow-down el-icon--right"}),e._v(" 信息")]),e._v(" "),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.patriarch_info.chlid_list,function(t,i){return s("el-dropdown-item",{key:i,attrs:{command:t.c_user_id}},[e._v("\n          "+e._s(t.c_nick_name)+"\n        ")])}),1)],1):e._e(),e._v(" "),-1!==["2","3"].indexOf(e.action)?s("div",{staticClass:"child-nick-name"},[e._v("孩子 "+e._s(e.forms.c_nick_name)+" 信息")]):e._e()],1),e._v(" "),s("div",{staticClass:"form-row"},[s("el-form",{ref:"child_forms",attrs:{model:e.forms,size:"mini","label-suffix":":","label-width":"120px","label-position":"left"},nativeOn:{submit:function(e){e.preventDefault()}}},[s("el-row",{attrs:{gutter:24}},[s("el-col",{staticClass:"col-bg",attrs:{xs:12,sm:8,md:6,lg:6,xl:4}},[s("div",{staticClass:"grid-content bg-purple"},[s("el-form-item",{attrs:{label:"手机号"}},[-1!==["1"].indexOf(e.action)?s("span",{staticClass:"label-text"},[e._v(e._s(e.current_child.c_phone))]):e._e(),e._v(" "),-1!==["2","3"].indexOf(e.action)?s("span",{staticClass:"label-text"},[e._v(e._s(e.forms.c_phone))]):e._e()])],1)]),e._v(" "),s("el-col",{staticClass:"col-bg",attrs:{xs:12,sm:8,md:6,lg:6,xl:4}},[s("div",{staticClass:"grid-content bg-purple",staticStyle:{width:"400px"}},[s("el-form-item",{attrs:{label:"孩子年级"}},[-1!==["1"].indexOf(e.action)?s("span",{staticClass:"label-text"},[e._v(e._s(e.current_child.c_grade_name))]):e._e(),e._v(" "),-1!==["2","3"].indexOf(e.action)?s("span",{staticClass:"label-text"},[e._v(e._s(e.forms.c_grade_name))]):e._e()])],1)]),e._v(" "),s("el-col",{staticClass:"col-bg",attrs:{xs:12,sm:8,md:6,lg:6,xl:4}},[s("div",{staticClass:"grid-content bg-purple",staticStyle:{width:"400px"}},[s("el-form-item",{attrs:{label:"注册时间"}},[-1!==["1"].indexOf(e.action)?s("span",{staticClass:"label-text"},[e._v(e._s(e.current_child.c_create_time))]):e._e(),e._v(" "),-1!==["2","3"].indexOf(e.action)?s("span",{staticClass:"label-text"},[e._v(e._s(e._f("dateFormatter")(e.forms.c_create_time,"YYYY-MM-DD HH:mm:ss")))]):e._e()])],1)])],1),e._v(" "),s("el-row",{attrs:{gutter:24}},[s("el-col",{staticClass:"col-bg",attrs:{xs:12,sm:8,md:6,lg:6,xl:4}},[s("div",{staticClass:"grid-content bg-purple"},[s("el-form-item",{attrs:{label:"绑定设备"}},[-1!==["1"].indexOf(e.action)?s("el-select",{attrs:{size:"mini",placeholder:"请选择绑定设备"},on:{change:e.change_child_device},model:{value:e.forms.c_device_id,callback:function(t){e.$set(e.forms,"c_device_id",t)},expression:"forms.c_device_id"}},e._l(e.child_device_list,function(e){return s("el-option",{key:e.c_device_id,attrs:{label:e.c_device_name,value:e.c_device_id}})}),1):e._e(),e._v(" "),-1!==["2","3"].indexOf(e.action)?s("span",{staticClass:"label-text"},[e._v(e._s(e.forms.c_device_name))]):e._e()],1)],1)]),e._v(" "),s("el-col",{staticClass:"col-bg",attrs:{xs:12,sm:8,md:6,lg:6,xl:4}},[s("div",{staticClass:"grid-content bg-purple",staticStyle:{width:"400px"}},[s("el-form-item",{attrs:{label:"终端类型"}},[-1!==["1"].indexOf(e.action)?s("span",{staticClass:"label-text"},[e._v(e._s(e.current_device.c_device_type_label))]):e._e(),e._v(" "),-1!==["2","3"].indexOf(e.action)?s("span",{staticClass:"label-text"},[e._v(e._s(e.forms.c_device_type_label))]):e._e()])],1)]),e._v(" "),s("el-col",{staticClass:"col-bg",attrs:{xs:12,sm:8,md:6,lg:6,xl:4}},[s("div",{staticClass:"grid-content bg-purple",staticStyle:{width:"400px"}},[s("el-form-item",{attrs:{label:"系统版本号"}},[-1!==["1"].indexOf(e.action)?s("span",{staticClass:"label-text"},[e._v(e._s(e.current_device.c_os_version))]):e._e(),e._v(" "),-1!==["2","3"].indexOf(e.action)?s("span",{staticClass:"label-text"},[e._v(e._s(e.forms.c_os_version))]):e._e()])],1)]),e._v(" "),s("el-col",{staticClass:"col-bg",attrs:{xs:12,sm:8,md:6,lg:6,xl:4}},[s("div",{staticClass:"grid-content bg-purple",staticStyle:{width:"400px"}},[s("el-form-item",{attrs:{label:"孩子端版本号"}},[-1!==["1"].indexOf(e.action)?s("span",{staticClass:"label-text"},[e._v(e._s(e.current_device.c_version))]):e._e(),e._v(" "),-1!==["2","3"].indexOf(e.action)?s("span",{staticClass:"label-text"},[e._v(e._s(e.forms.c_version))]):e._e()])],1)]),e._v(" "),s("el-col",{staticClass:"col-bg",attrs:{xs:12,sm:8,md:6,lg:6,xl:4}},[s("div",{staticClass:"grid-content bg-purple",staticStyle:{width:"400px"}},[s("el-form-item",{attrs:{label:"绑定状态"}},[-1!==["1"].indexOf(e.action)?s("span",{staticClass:"label-text"},[e._v(e._s(e.current_device.c_bind_type))]):e._e(),e._v(" "),-1!==["2","3"].indexOf(e.action)?s("span",{staticClass:"label-text"},[e._v(e._s(e.forms.c_bind_type))]):e._e()])],1)]),e._v(" "),s("el-col",{staticClass:"col-bg",attrs:{xs:12,sm:8,md:6,lg:6,xl:4}},[s("div",{staticClass:"grid-content bg-purple",staticStyle:{width:"400px"}},[s("el-form-item",{attrs:{label:"绑定时间"}},[-1!==["1"].indexOf(e.action)?s("span",{staticClass:"label-text"},[e._v(e._s(e.current_device.c_bind_time))]):e._e(),e._v(" "),-1!==["2","3"].indexOf(e.action)?s("span",{staticClass:"label-text"},[e._v(e._s(e._f("dateFormatter")(e.forms.c_bind_time,"YYYY-MM-DD HH:mm:ss")))]):e._e()])],1)]),e._v(" "),s("el-col",{staticClass:"col-bg",attrs:{xs:12,sm:8,md:6,lg:6,xl:4}},[s("div",{staticClass:"grid-content bg-purple",staticStyle:{width:"400px"}},[s("el-form-item",{attrs:{label:"解绑时间"}},[-1!==["1"].indexOf(e.action)?s("span",{staticClass:"label-text"},[e._v(e._s(e.current_device.c_unbind_time))]):e._e(),e._v(" "),-1!==["2","3"].indexOf(e.action)?s("span",{staticClass:"label-text"},[e._v(e._s(e._f("dateFormatter")(e.forms.c_unbind_time,"YYYY-MM-DD HH:mm:ss")))]):e._e()])],1)])],1)],1)],1),e._v(" "),s("div",{staticClass:"form-diviser mt-10 mb-10"},[e._v("工单详情")]),e._v(" "),s("el-form",{ref:"work_order_detail",attrs:{model:e.forms,rules:e.work_order_detail_rules,size:"mini","label-suffix":":","label-width":"120px","label-position":"left"},nativeOn:{submit:function(e){e.preventDefault()}}},[-1!==["1","2"].indexOf(e.action)?s("el-row",{staticClass:"form-row",attrs:{gutter:24}},[s("el-col",{staticClass:"col-bg",attrs:{xs:24,sm:24,md:24,lg:24,xl:24}},[s("div",{staticClass:"grid-content bg-purple"},[s("el-form-item",{attrs:{label:"问题描述",prop:"problem_description"}},[s("tinymce",{staticClass:"question-details",attrs:{height:200},model:{value:e.forms.problem_description,callback:function(t){e.$set(e.forms,"problem_description",t)},expression:"forms.problem_description"}}),e._v(" "),-1!==["3"].indexOf(e.action)?s("div",{staticClass:"problem-description",domProps:{innerHTML:e._s(e.forms.problem_description)}}):e._e()],1)],1)]),e._v(" "),s("el-col",{staticClass:"col-bg",attrs:{xs:24,sm:24,md:24,lg:24,xl:24}},[s("div",{staticClass:"grid-content bg-purple"},[s("el-form-item",{attrs:{label:"处理人",prop:"assigned_ao_id"}},[s("el-select",{attrs:{size:"mini",filterable:"",placeholder:"请选择处理人"},model:{value:e.forms.assigned_ao_id,callback:function(t){e.$set(e.forms,"assigned_ao_id",t)},expression:"forms.assigned_ao_id"}},e._l(e.handler_users,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1)])],1):-1!==["3"].indexOf(e.action)?s("div",{staticClass:"work-order-detail-block"},[s("p",{staticClass:"detail-desc-title"},[s("span",{staticClass:"desc",class:{active:"1"===e.detail_active},on:{click:function(t){e.detail_active="1"}}},[e._v("问题描述")]),e._v(" "),s("span",{staticClass:"between-desc-history"},[e._v("|")]),e._v(" "),s("span",{staticClass:"history",class:{active:"2"===e.detail_active},on:{click:function(t){e.detail_active="2"}}},[e._v("变更历史")])]),e._v(" "),"1"===e.detail_active?s("div",{staticClass:"detail-content"},["01"===e.identity&&-1!==["3","4"].indexOf(e.work_order_state)?[s("el-row",{staticClass:"form-row",attrs:{gutter:24}},[s("el-col",{staticClass:"col-bg",attrs:{xs:24,sm:24,md:24,lg:24,xl:24}},[s("div",{staticClass:"grid-content bg-purple"},[s("el-form-item",{attrs:{label:"问题描述",prop:"problem_description"}},[s("tinymce",{staticClass:"question-details",attrs:{height:200},model:{value:e.forms.problem_description,callback:function(t){e.$set(e.forms,"problem_description",t)},expression:"forms.problem_description"}})],1)],1)]),e._v(" "),s("el-col",{staticClass:"col-bg",attrs:{xs:24,sm:24,md:24,lg:24,xl:24}},[s("div",{staticClass:"grid-content bg-purple"},[s("el-form-item",{attrs:{label:"处理人",prop:"assigned_ao_id"}},["1"===e.action?s("el-select",{attrs:{size:"mini",placeholder:"请选择处理人",clearable:""},model:{value:e.forms.assigned_ao_id,callback:function(t){e.$set(e.forms,"assigned_ao_id",t)},expression:"forms.assigned_ao_id"}},e._l(e.handler_users,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1):e._e(),e._v(" "),-1!==["2","3"].indexOf(e.action)?s("span",{staticClass:"label-text"},[e._v(e._s(e.forms.assigned_ao_name))]):e._e()],1)],1)])],1)]:[-1!==["3"].indexOf(e.action)?s("div",{domProps:{innerHTML:e._s(e.forms.problem_description)}}):e._e()]],2):e._e(),e._v(" "),"2"===e.detail_active?s("div",{staticClass:"detail-content detail-change-content"},[s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.history_record_loading,expression:"history_record_loading"}],staticClass:"history-table",attrs:{data:e.ticket_change_records,size:"mini",stripe:""}},[s("el-table-column",{attrs:{label:"变更时间",width:"140","empty-text":"暂无历史变更记录",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[e._v(e._s(e._f("dateFormatter")(t.row.create_time,"YYYY-MM-DD HH:mm:ss")))])]}}],null,!1,337289909)}),e._v(" "),s("el-table-column",{attrs:{align:"center",label:"变更人",width:"108",prop:"user_real_name"}}),e._v(" "),s("el-table-column",{attrs:{align:"center",label:"变更类型",width:"108",prop:"change_type_name"}}),e._v(" "),s("el-table-column",{attrs:{align:"center",label:"变更前",prop:"before_change"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",{attrs:{title:t.row.before_change}},[e._v(e._s(e._f("beautifyWordsFormatter")(t.row.before_change,50)))])]}}],null,!1,114881866)}),e._v(" "),s("el-table-column",{attrs:{align:"center",label:"变更后",prop:"after_change"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",{attrs:{title:t.row.after_change}},[e._v(e._s(e._f("beautifyWordsFormatter")(t.row.after_change,50)))])]}}],null,!1,1224687210)}),e._v(" "),s("el-table-column",{attrs:{align:"center",label:"备注",prop:"remark"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",{attrs:{title:t.row.remark}},[e._v(e._s(e._f("beautifyWordsFormatter")(t.row.remark,50)))])]}}],null,!1,1051686730)})],1)],1):e._e()]):e._e()],1),e._v(" "),-1===["1"].indexOf(e.action)?s("div",{staticClass:"comment-block"},[s("hr",{staticClass:"comment"}),e._v(" "),s("p",{staticClass:"comment-title"},[e._v("评论 "),s("span",{staticClass:"add-comment",on:{click:e.add_comment}},[e._v("+ 评论")])]),e._v(" "),s("div",{staticClass:"comment-items"},[0!==e.ticket_comments.length?e._l(e.ticket_comments,function(t,r){return s("div",{key:r,staticClass:"comment-item"},[s("div",{staticClass:"left"},[s("img",{attrs:{src:t.img_url||i("aXb4"),alt:""}})]),e._v(" "),s("div",{staticClass:"right"},[s("div",{staticClass:"comment-info"},[s("p",{staticClass:"comment-time-point"},[s("span",{staticClass:"real-name"},[e._v(e._s(t.real_name))]),e._v(" "),s("span",{staticClass:"role-name"},[e._v(e._s(t.role_name))]),e._v(" "),s("span",{staticClass:"create-date"},[e._v(e._s(e._f("dateFormatter")(t.create_time,"YYYY-MM-DD HH:mm:ss")))]),e._v(" "),t.cc_user&&0!==t.cc_user.length?s("span",{staticClass:"comment-copy-to"},[e._v("抄送："+e._s(t.cc_user.join("、")))]):e._e()])]),e._v(" "),s("div",{staticClass:"comment-content"},[s("div",{domProps:{innerHTML:e._s(t.comment)}})])])])}):[s("p",{staticClass:"no-comments-work-order"},[e._v("暂时没有评论内容")])]],2)]):e._e(),e._v(" "),-1!==["3"].indexOf(e.action)?s("div",{staticClass:"work-order-next"},[s("p",{staticClass:"work-order-title"},[e._v("工单处理")]),e._v(" "),s("div",{staticClass:"work-order-next-content"},[s("el-form",{ref:"assigned_forms",attrs:{model:e.assigned_forms,rules:e.assigned_rules,size:"mini","label-suffix":":","label-width":"120px","label-position":"left"},nativeOn:{submit:function(e){e.preventDefault()}}},[s("el-row",{staticClass:"form-row",attrs:{gutter:24}},[s("el-col",{attrs:{xs:12,sm:12,md:8,lg:6,xl:4}},[s("div",{staticClass:"grid-content bg-purple"},[s("el-form-item",{attrs:{label:"处理人"}},[s("span",{staticClass:"label-text"},[e._v(e._s(e.forms.assigned_ao_name))])])],1)]),e._v(" "),s("el-col",{attrs:{xs:12,sm:12,md:8,lg:6,xl:4}},[s("div",{staticClass:"grid-content bg-purple"},[s("el-form-item",{attrs:{label:"当前状态",prop:"state"}},["02"===e.identity&&-1!==["3","4"].indexOf(e.work_order_state)?[s("el-select",{attrs:{size:"mini",placeholder:"请选择当前状态"},model:{value:e.assigned_forms.state,callback:function(t){e.$set(e.assigned_forms,"state",t)},expression:"assigned_forms.state"}},e._l(e.work_orders_status.filter(function(e){return-1!==["1","3"].indexOf(e.value)}),function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)]:[s("span",{staticClass:"label-text"},[e._v(e._s(e.forms.state_label))])]],2)],1)]),e._v(" "),s("el-col",{attrs:{xs:12,sm:12,md:8,lg:6,xl:4}},[s("div",{staticClass:"grid-content bg-purple"},[s("el-form-item",{attrs:{label:"问题归类",prop:"state"}},["02"===e.identity&&-1!==["3","4"].indexOf(e.work_order_state)?[s("el-select",{attrs:{size:"mini",placeholder:"请选择问题归类"},model:{value:e.assigned_forms.problem_type,callback:function(t){e.$set(e.assigned_forms,"problem_type",t)},expression:"assigned_forms.problem_type"}},e._l(e.work_orders_question_classifies,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)]:[s("span",{staticClass:"label-text"},[e._v(e._s(e.forms.problem_type_label))])]],2)],1)])],1),e._v(" "),"02"===e.identity&&-1!==["3","4"].indexOf(e.work_order_state)?[s("el-row",{staticClass:"form-row",attrs:{gutter:24}},[s("el-col",{attrs:{span:24}},[s("div",{staticClass:"grid-content bg-purple"},[s("el-form-item",{attrs:{label:"评论",prop:"comment"}},[s("tinymce",{staticClass:"question-details",attrs:{height:200},model:{value:e.assigned_forms.comment,callback:function(t){e.$set(e.assigned_forms,"comment",t)},expression:"assigned_forms.comment"}})],1)],1)])],1)]:e._e()],2)],1)]):e._e(),e._v(" "),s("div",{staticClass:"form-diviser mt-10"},[e._v("历史关联工单")]),e._v(" "),s("div",{staticClass:"history-work-order-items"},[0!==e.histories.length?e._l(e.histories,function(t,i){return s("p",{key:i,staticClass:"history-work-order-item"},[s("span",{staticClass:"history-index"},[e._v(e._s(i+1)+". ")]),e._v(" "),s("a",{attrs:{href:"javascript:;"},on:{click:function(i){return e.jump_to_history_page(t.ticket_id)}}},[s("span",{attrs:{title:t.ticket_title}},[e._v(e._s(e._f("beautifyWordsFormatter")(t.ticket_title,30)))]),e._v(" "),s("span",[e._v(" - ")]),e._v(" "),s("span",[e._v(e._s(e._f("dateFormatter")(t.create_time,"YYYY-MM-DD HH:mm:ss")))])])])}):[s("p",{staticClass:"no-history-work-order"},[e._v("该用户暂无历史关联工单")])]],2),e._v(" "),s("el-dialog",{attrs:{"before-close":e.before_close_transfer,visible:e.transfer_visible,top:"10vh",title:"工单转交",width:"800px"},on:{"update:visible":function(t){e.transfer_visible=t}}},[s("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.transfer_form_loading,expression:"transfer_form_loading"}],ref:"transfer_form",attrs:{model:e.transfer_form,rules:e.transfer_rules,"label-width":"120px"},nativeOn:{submit:function(e){e.preventDefault()}}},[s("el-form-item",{attrs:{label:"转交给",prop:"after_user_id"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{size:"mini",placeholder:"请选择转交人",filterable:""},on:{change:e.change_terminal_type},model:{value:e.transfer_form.after_user_id,callback:function(t){e.$set(e.transfer_form,"after_user_id",t)},expression:"transfer_form.after_user_id"}},e._l(e.tranfer_users,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),s("el-form-item",{attrs:{label:"备注",prop:"remark"}},[s("el-input",{attrs:{type:"textarea",rows:"4",resize:"none"},model:{value:e.transfer_form.remark,callback:function(t){e.$set(e.transfer_form,"remark",t)},expression:"transfer_form.remark"}})],1),e._v(" "),s("el-form-item",{staticStyle:{"text-align":"right"}},[s("el-button",{attrs:{size:"mini"},on:{click:e.close_transfer_dialog}},[e._v("取消")]),e._v(" "),s("el-button",{attrs:{loading:e.submit_transfer_work_order_loading,size:"mini",type:"primary"},on:{click:e.submit_transfer_form}},[e._v("确定\n        ")])],1)],1)],1),e._v(" "),s("el-dialog",{attrs:{"before-close":e.close_comment_dialog,visible:e.comment_visible,top:"10vh",title:"评论",width:"800px"},on:{"update:visible":function(t){e.comment_visible=t}}},[s("el-form",{ref:"comment_form",attrs:{model:e.comment_form,rules:e.comment_rules,"label-suffix":":","label-width":"120px"},nativeOn:{submit:function(e){e.preventDefault()}}},[s("el-form-item",{attrs:{label:"评论",prop:"comment"}},[s("tinymce",{ref:"tinymce_comment",staticClass:"comment-details",attrs:{height:200},model:{value:e.comment_form.comment,callback:function(t){e.$set(e.comment_form,"comment",t)},expression:"comment_form.comment"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"抄送谁看",prop:"cc_user_id"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{size:"mini",multiple:"",filterable:"",placeholder:"抄送谁看"},model:{value:e.comment_form.cc_users,callback:function(t){e.$set(e.comment_form,"cc_users",t)},expression:"comment_form.cc_users"}},e._l(e.comment_and_copy_users,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),s("el-form-item",{staticStyle:{"text-align":"right"}},[s("el-button",{attrs:{size:"mini"},on:{click:e.close_comment_dialog}},[e._v("取消")]),e._v(" "),s("el-button",{attrs:{loading:e.submit_comment_order_loading,size:"mini",type:"primary"},on:{click:e.submit_comment}},[e._v("提交\n        ")])],1)],1)],1)],1)},[],!1,null,"499d186c",null);t.default=b.exports},Zkmf:function(e,t,i){"use strict";i.d(t,"a",function(){return u}),i.d(t,"b",function(){return f});var s,r,a=i("14Xm"),n=i.n(a),o=i("D3Ub"),l=i.n(o),c=i("+bwJ"),_=i("vDqi"),d=i.n(_),m=i("z0WU"),u=(s=l()(n.a.mark(function e(t){var i,s,r,a,o,l;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.a)(t);case 2:return i=e.sent,s={hash:i},r={headers:{"Content-Type":"application/json"},baseURL:"/gelei-guard-bms/api"},a="/file/data/secondpass",o=Object(c.a)(s),l=JSON.parse(o),e.next=10,d.a.post(a,l,r);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}},e,this)})),function(e){return s.apply(this,arguments)}),f=(r=l()(n.a.mark(function e(t){var i,s,r,a,o,l,_,u;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(i=new FormData).append("file",t),e.next=4,Object(m.a)(t);case 4:for(u in s=e.sent,r={hash:s},a={headers:{"Content-Type":"multipart/form-data"},baseURL:"/gelei-guard-bms/api"},o=Object(c.a)(r),l="/file/data/upload",_=JSON.parse(o))i.append(u,_[u]);return e.next=13,d.a.post(l,i,a);case 13:return e.abrupt("return",e.sent);case 14:case"end":return e.stop()}},e,this)})),function(e){return r.apply(this,arguments)})},glbJ:function(e,t,i){"use strict";var s=i("4d7F"),r=i.n(s),a=i("GQeE"),n=i.n(a),o=i("Zkmf"),l=["image/png","image/jpg","image/jpeg","image/gif","image/bmp"],c=["video/ogg","video/mp4","video/webm","video/flv","video/avi","video/wmv","video/rmvb"],_={name:"EditorSlideUpload",props:{color:{type:String,default:"#1890ff"}},data:function(){return{dialogVisible:!1,listObj:{},fileList:[]}},methods:{beforeClose:function(){var e=this;this.$confirm("确认关闭上传图片/视频接口么?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.dialogVisible=!1})},checkAllSuccess:function(){var e=this;return n()(this.listObj).every(function(t){return e.listObj[t].hasSuccess})},handleSubmit:function(){var e=this,t=n()(this.listObj).map(function(t){return e.listObj[t]});this.checkAllSuccess()?(this.$emit("successCBK",t),this.listObj={},this.fileList=[],this.dialogVisible=!1):this.$message("请等待所有图片上传成功 或 出现了网络问题，请刷新页面重新上传！")},handleSuccess:function(e,t){for(var i=t.uid,s=n()(this.listObj),r=0,a=s.length;r<a;r++)if(this.listObj[s[r]].uid===i)return this.listObj[s[r]].url=e,void(this.listObj[s[r]].hasSuccess=!0)},handleExceed:function(e,t){},handleRemove:function(e){var t=e.uid,i=n()(this.listObj);this.fileList=this.fileList.filter(function(e){return e.uid!==t});for(var s=0,r=i.length;s<r;s++)if(this.listObj[i[s]].uid===t)return void delete this.listObj[i[s]]},checkFileStatus:function(e){var t=e.type,i=e.size;if(-1!==l.indexOf(t)||-1!==c.indexOf(t)){if(-1!==l.indexOf(t)){if(i>10485760)return this.$message.error("上传图片大小限制在10MB内"),this.handleRemove(e),!1}else if(-1!==c.indexOf(t)&&i>52428800)return this.$message.error("上传视频文件限制在50MB内"),this.handleRemove(e),!1;return!0}return this.$message.error("文件格式不为图片或视频格式"),!1},beforeUpload:function(e){var t=this.checkFileStatus(e);if(!t)return t;var i=this,s=window.URL||window.webkitURL,a=e.uid,n=e.type;if(this.listObj[a]={},-1!==l.indexOf(n)){return new r.a(function(t,r){var o=new Image;o.src=s.createObjectURL(e),o.onload=function(){i.listObj[a]={hasSuccess:!1,uid:e.uid,file_type:"image",type:n,width:this.width,height:this.height}},t(!0)})}if(-1!==c.indexOf(n)){return this.listObj[a]={hasSuccess:!1,uid:e.uid,file_type:"vedio",type:n,width:400,height:400},!0}return!1},pushPictureToAliOss:function(e){var t=this,i=e.file;this.beforeUpload(i);var s={name:i.name,uid:i.uid,type:i.type,url:""};Object(o.a)(i).then(function(e){var r=e.data;if(-1!==[1,-2,"-2"].indexOf(r.status))Object(o.b)(i).then(function(e){var r=e.data;if(0===r.status){var a=r.data.url;s.url=a,t.fileList.push(s),t.handleSuccess(a,s)}else t.handleRemove(i),t.$message.error(r.message)}).catch(function(){t.handleRemove(i)});else if(-1===r.status)t.handleRemove(i),t.$message.error(r.message);else if(0===r.status){var a=r.data.url;s.url=a,t.fileList.push(s),t.handleSuccess(a,s)}else t.handleRemove(i),t.$message.error(r.message)})}}},d=(i("9iEX"),i("KHd+")),m=["advlist anchor autolink autosave code codesample colorpicker colorpicker contextmenu directionality emoticons fullscreen hr image imagetools insertdatetime link lists media nonbreaking noneditable pagebreak paste preview print save searchreplace spellchecker tabfocus table template textcolor textpattern visualblocks visualchars wordcount"],u=["removeformat undo redo |  bullist numlist | outdent indent | forecolor | fullscreen | subscript superscript codesample","bold italic underline strikethrough blockquote | h2 p  media link | alignleft aligncenter alignright | fontsizeselect | fontselect"],f={name:"Tinymce",components:{editorImage:Object(d.a)(_,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"upload-container"},[i("el-button",{style:{background:e.color,borderColor:e.color},attrs:{type:"primary",icon:"el-icon-upload",size:"mini"},on:{click:function(t){e.dialogVisible=!0}}},[i("span",[e._v("上传图片/视频")])]),e._v(" "),i("el-dialog",{attrs:{"before-close":e.beforeClose,visible:e.dialogVisible,top:"25vh",title:"上传图片/视频",width:"760px","append-to-body":""},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("el-upload",{staticClass:"editor-slide-upload",attrs:{"http-request":e.pushPictureToAliOss,"file-list":e.fileList,multiple:!0,"on-remove":e.handleRemove,"on-success":e.handleSuccess,"show-file-list":!0,"before-upload":e.beforeUpload,action:"","list-type":"picture-card"},on:{exceed:e.handleExceed}},[i("el-button",{attrs:{size:"mini",type:"primary"}},[e._v("点击上传")]),e._v(" "),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传图片和视频文件，且图片大小限制在10MB以内，视频大小限制在50MB以内")])],1),e._v(" "),i("div",{staticStyle:{"text-align":"right"}},[i("el-button",{attrs:{size:"mini"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.handleSubmit}},[e._v("确 定")])],1)],1)],1)},[],!1,null,"a4bf9a02",null).exports},props:{id:{type:String,default:function(){return"vue-tinymce-"+ +new Date+(1e3*Math.random()).toFixed(0)}},value:{type:String,default:""},toolbar:{type:Array,required:!1,default:function(){return[]}},menubar:{type:String,default:"file edit insert view format table"},height:{type:Number,required:!1,default:360}},data:function(){return{hasChange:!1,hasInit:!1,tinymceId:this.id,fullscreen:!1,languageTypeList:{en:"en",zh:"zh_CN"}}},computed:{language:function(){return this.languageTypeList[this.$store.getters.language]}},watch:{value:function(e){var t=this;!this.hasChange&&this.hasInit&&this.$nextTick(function(){return window.tinymce.get(t.tinymceId).setContent(e||"")})},language:function(){var e=this;this.destroyTinymce(),this.$nextTick(function(){return e.initTinymce()})}},mounted:function(){this.initTinymce()},activated:function(){this.initTinymce()},deactivated:function(){this.destroyTinymce()},destroyed:function(){this.destroyTinymce()},methods:{initTinymce:function(){var e=this,t=this;window.tinymce.init({language:this.language,selector:"#"+this.tinymceId,relative_urls:!1,remove_script_host:!1,autosave_ask_before_unload:!1,media_live_embeds:!0,height:this.height,statusbar:!1,body_class:"panel-body ",object_resizing:!1,toolbar:this.toolbar.length>0?this.toolbar:u,menubar:this.menubar,plugins:m,fontsize_formats:"8pt 10pt 12pt 14pt 18pt 24pt 36pt",end_container_on_empty_block:!0,powerpaste_word_import:"clean",code_dialog_height:450,code_dialog_width:1e3,advlist_bullet_styles:"square",advlist_number_styles:"default",imagetools_cors_hosts:["www.tinymce.com","codepen.io"],default_link_target:"_self",link_title:!1,nonbreaking_force_tab:!0,init_instance_callback:function(i){t.value&&i.setContent(t.value),t.hasInit=!0,i.on("NodeChange Change KeyUp SetContent",function(){e.hasChange=!0,e.$emit("input",i.getContent())})},setup:function(e){e.on("FullscreenStateChanged",function(e){t.fullscreen=e.state})},images_upload_handler:function(e,t,i,s){}})},destroyTinymce:function(){var e=window.tinymce.get(this.tinymceId);this.fullscreen&&e.execCommand("mceFullScreen"),e&&e.destroy()},setContent:function(e){window.tinymce.get(this.tinymceId).setContent(e)},getContent:function(){window.tinymce.get(this.tinymceId).getContent()},imageSuccessCBK:function(e){var t=this;e.forEach(function(e){if("image"===e.file_type){var i=void 0,s=void 0;e.width>400&&(i=400,s=e.height*(i/e.width)),window.tinymce.get(t.tinymceId).insertContent('<img class="wscnph" src="'+e.url+'" width="'+i+'" height="'+s+'" >')}else{var r='<iframe src="'+e.url+'" frameborder="0" gesture="media" allow="encrypted-media" allowfullscreen></iframe>';window.tinymce.get(t.tinymceId).insertContent(""+r)}})}}},p=(i("6CbA"),Object(d.a)(f,function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"tinymce-container editor-container",class:{fullscreen:this.fullscreen}},[t("textarea",{staticClass:"tinymce-textarea",attrs:{id:this.tinymceId}}),this._v(" "),t("div",{staticClass:"editor-custom-btn-container"},[t("editorImage",{staticClass:"editor-upload-btn",attrs:{color:"#1890ff"},on:{successCBK:this.imageSuccessCBK}})],1)])},[],!1,null,"f5ccc806",null));t.a=p.exports},ifnG:function(e,t,i){},l05Z:function(e,t,i){"use strict";var s=i("8r5B");i.n(s).a}}]);