(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-8ad8"],{"+F/X":function(e,t,s){},FyfS:function(e,t,s){e.exports={default:s("Rp86"),__esModule:!0}},PTw5:function(e,t,s){},Rp86:function(e,t,s){s("bBy9"),s("FlQf"),e.exports=s("fXsU")},S92F:function(e,t,s){"use strict";s.r(t);var a=s("QbLZ"),r=s.n(a),o=s("GQeE"),n=s.n(o),l=s("FyfS"),i=s.n(l),c=s("gDS+"),u=s.n(c),_=s("S583"),d=s("ut4/"),m=s("Yfch"),p=s("YP4+"),f={name:"ResetSystemAccountPassword",props:{showDialog:{type:Boolean,default:!0},userId:{type:String,default:""}},data:function(){var e=this;return{title:"重置密码",password_min_length:p.H,password_max_length:p.G,form:{new_password:"",confirm_password:""},rules:{new_password:[{trigger:"blur",required:!0,message:"请输入密码"},{validator:function(e,t,s){var a=Object(m.c)(t);a.status?s():s(new Error(a.message))},trigger:"blur"}],confirm_password:[{trigger:"blur",required:!0,message:"请再次输入密码"},{validator:function(t,s,a){var r=Object(m.c)(s);r.status?s!==e.form.new_password?a(new Error("两次输入密码不一致!")):a():a(new Error(r.message))},trigger:"blur"}]}}},computed:{show:function(){return this.showDialog}},mounted:function(){},methods:{before_close:function(){this.$emit("callback")},close_dialog:function(){this.$emit("callback")},reset_password:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;var s={user_id:t.userId,new_password:Object(d.b)(t.form.new_password),confirm_password:Object(d.b)(t.form.confirm_password)};Object(_.dc)(s).then(function(e){0===e.status?(t.$message.success(e.message),t.$emit("callback")):"新密码不能旧密码一致"===e.message?t.$confirm("新密码不能和旧密码一致，请重新输入","提示",{confirmButtonText:"确认",type:"warning",center:!0}):t.$message.error(e.message)})})}}},g=(s("iwWg"),s("KHd+")),b=Object(g.a)(f,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"component-card"},[s("el-dialog",{attrs:{title:e.title,visible:e.show,"before-close":e.before_close,width:"40%"},on:{"update:visible":function(t){e.show=t}}},[s("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-suffix":":",size:"mini","label-width":"120px"}},[s("el-form-item",{attrs:{label:"新密码",prop:"new_password"}},[s("el-input",{attrs:{minlength:e.password_min_length,maxlength:e.password_max_length,type:"password",autocomplete:"off",placeholder:"请输入新密码"},model:{value:e.form.new_password,callback:function(t){e.$set(e.form,"new_password",t)},expression:"form.new_password"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"密码确认",prop:"confirm_password"}},[s("el-input",{attrs:{minlength:e.password_min_length,maxlength:e.password_max_length,type:"password",autocomplete:"off",placeholder:"请再次输入新密码"},model:{value:e.form.confirm_password,callback:function(t){e.$set(e.form,"confirm_password",t)},expression:"form.confirm_password"}})],1)],1),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"mini"},on:{click:e.close_dialog}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{pid:"10024",type:"primary",size:"mini"},on:{click:function(t){return e.reset_password("form")}}},[e._v("确认")])],1)],1)],1)},[],!1,null,"9f70671a",null).exports,h=s("4d7F"),v=s.n(h),w=s("z0WU"),y=s("L2JU"),x={name:"CreateAndEditSystemAccount",props:{showDialog:{type:Boolean,default:!0},userId:{type:String,default:""},user:{type:Object,default:function(){return{}}}},data:function(){return{title:"",password_min_length:p.H,password_max_length:p.G,form:{user_id:"",real_name:"",role_id:"",account_type:"",password:""},rules:{user_id:[{required:!0,message:"账户名称不能为空",trigger:"blur"},{message:"账户名称只能由英文、数字及特殊符号组成",trigger:"blur",validator:function(e,t,s){Object(m.b)(t).status?s(new Error("用户账户名称不符合规范")):s()}}],real_name:[{required:!0,message:"真实姓名不能为空",trigger:"blur"}],role_id:[{required:!0,message:"请选择账号角色",trigger:"blur"}],account_type:[{required:!0,message:"请选择账号类型",trigger:"blur"}],password:[{required:!0,message:"登录密码不能为空",trigger:"blur"},{validator:function(e,t,s){var a=Object(m.c)(t);a.status?s():s(new Error(a.message))},trigger:"blur"}]},loading:!0,roles:[],account_name_list:p.a}},computed:r()({},Object(y.b)(["is_agent"]),{show:function(){return this.showDialog}}),mounted:function(){this.init_dialog_data()},methods:{before_close:function(){},close_dialog:function(){this.$emit("callback",!1)},init_dialog_data:function(){var e=this;this.loading=!0,void 0!==this.user.user_id?this.form.account_type=this.user.account_type:this.form.account_type="",this.fetch_sys_roles().then(function(){void 0!==e.user.user_id?(e.title="编辑账号",e.form={user_id:e.user.user_id,real_name:e.user.real_name,role_id:e.user.role_id,account_type:e.user.account_type,password:""}):(e.title="创建账号",e.form={user_id:"",real_name:"",role_id:"",account_type:"",password:""})}).finally(function(){e.loading=!1})},account_type_change:function(e){this.form.role_id="",this.fetch_sys_roles()},fetch_sys_roles:function(){var e=this;return new v.a(function(t,s){var a={account_type:e.form.account_type};Object(_.R)(a).then(function(s){0===s.status?e.roles=s.data.map(function(e){return{value:e.role_id,label:e.role_name}}):e.roles=[],t()}).catch(function(){s()})})},create_or_save:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;var s={user_id:t.form.user_id,real_name:t.form.real_name,account_type:t.form.account_type,role_id:t.form.role_id};t.user.user_id||(s.password=Object(d.b)(t.form.password)),s=Object(w.q)(s),Object(_.i)(s).then(function(e){0===e.status?(t.$message.success(e.message),t.$emit("callback")):t.$message.error(e.message)})})}}},k=(s("gkkV"),Object(g.a)(x,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"component-card"},[s("el-dialog",{attrs:{title:e.title,visible:e.show,"before-close":e.before_close,width:"40%"},on:{"update:visible":function(t){e.show=t}}},[s("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"form",attrs:{model:e.form,rules:e.rules,"label-suffix":":",size:"mini","label-width":"120px"}},[s("el-form-item",{attrs:{label:"账号名称",prop:"user_id"}},[s("el-input",{attrs:{disabled:void 0!==e.user.user_id,maxlength:"15",placeholder:"请输入账号名称"},model:{value:e.form.user_id,callback:function(t){e.$set(e.form,"user_id",t)},expression:"form.user_id"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"真实姓名",prop:"real_name"}},[s("el-input",{attrs:{autocomplete:"off",placeholder:"请输入真实姓名"},model:{value:e.form.real_name,callback:function(t){e.$set(e.form,"real_name",t)},expression:"form.real_name"}})],1),e._v(" "),e.user.user_id?e._e():s("el-form-item",{attrs:{label:"登录密码",prop:"password"}},[s("el-input",{attrs:{minlength:e.password_min_length,maxlength:e.password_max_length,type:"password",autocomplete:"off",placeholder:"请输入登录密码"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"账号类型",prop:"account_type"}},[s("el-select",{staticClass:"role-select",attrs:{disabled:!!e.user.user_id,size:"mini",filterable:"",remote:"",clearable:"",placeholder:"请选择账号类型"},on:{change:e.account_type_change},model:{value:e.form.account_type,callback:function(t){e.$set(e.form,"account_type",t)},expression:"form.account_type"}},e._l(e.account_name_list,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),s("el-form-item",{attrs:{label:"账号角色",prop:"role_id"}},[s("el-select",{staticClass:"role-select",attrs:{disabled:"01"===e.form.account_type&&!!e.user.user_id,size:"mini",filterable:"",remote:"",clearable:"",placeholder:"请选择账号角色"},model:{value:e.form.role_id,callback:function(t){e.$set(e.form,"role_id",t)},expression:"form.role_id"}},e._l(e.roles,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"mini"},on:{click:e.close_dialog}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{pid:"10069,10064",type:"primary",size:"mini"},on:{click:function(t){return e.create_or_save("form")}}},[e._v("确认")])],1)],1)],1)},[],!1,null,"70c2e9de",null).exports),z=s("X4fA"),$={name:"AccountManagement",components:{ResetSystemAccountPassword:b,CreateAndEditSystemAccount:k},data:function(){var e=Object(z.a)();return{loading:!1,query_sets:{user_id:"",real_name:"",role_id:"",account_type:"",state:""},current_user:{},current_user_id:"",show_reset_pannel:!1,show_create_or_edit_pannel:!1,account_name_list:p.a,roles:[],resource:[],system_account_enable_state:p.Q,page:1,page_size:e,page_sizes:p.T,total:0}},mounted:function(){var e=this;Object(_.R)().then(function(t){0===t.status?(e.roles=t.data.map(function(e){return{value:e.role_id,label:e.role_name}}),e.fetch_system_users()):e.$message.error(t.message)})},methods:{show_table_button_label:function(e){return"1"===e.state?"关闭":"开启"},get_condition:function(){var e=JSON.parse(u()(this.query_sets)),t={},s=!0,a=!1,r=void 0;try{for(var o,l=i()(n()(e));!(s=(o=l.next()).done);s=!0){var c=o.value;e[c]&&(t[c]=e[c])}}catch(e){a=!0,r=e}finally{try{!s&&l.return&&l.return()}finally{if(a)throw r}}return t},get_condition_with_pagination:function(){var e=this.get_condition();return e.page_no=this.page,e.page_num=this.page_size,e},query_condition_change:function(){this.page=1,this.query()},query:function(){this.fetch_system_users()},fetch_system_users:function(){var e=this;this.loading=!0;var t=this.get_condition_with_pagination();Object(_.Pb)(t).then(function(t){if(0===t.status){e.total=t.total_count;var s=(e.page-1)*e.page_size+1;e.resource=t.data.map(function(e,t){var a=Object(w.o)(e.account_type,p.a,p.a[0].label),o=Object(w.b)(e.create_time,p.o,!1),n=Object(w.b)(e.first_login_time,p.o,!1),l=Object(w.o)(e.state,p.Q);return r()({_idx:s+t},e,{state_label:l,account_name:a,first_login_time_label:n,create_time_label:o})})}else e.$message.error(t.message)}).finally(function(){e.loading=!1})},reset_account_password:function(e){this.current_user_id=e.user_id,this.show_reset_pannel=!0},reset_callback:function(){this.show_reset_pannel=!1,this.current_user_id=""},create_or_edit_callback:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.current_user={},this.show_create_or_edit_pannel=!1,e&&this.query()},edit_account:function(e){this.current_user=e,this.show_create_or_edit_pannel=!0},create_account:function(){this.current_user={},this.show_create_or_edit_pannel=!0},change_account_state:function(e){var t=this;Object(_.J)(e).then(function(e){0===e.status?(t.$message.success(e.message),t.query()):t.$message.error(e.message)})},confirm_change_account_state:function(e){var t=this,s=void 0,a=void 0;"0"===e.state?(s="你确定要开启该账号吗？",a="1"):"1"===e.state?(s="你确定要关闭该账号吗？",a="0"):(s="用户账号异常，请取消本次操作!",a=null),this.$confirm(s,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){if(a){var s={state:a,user_id:e.user_id};t.change_account_state(s)}}).catch(function(){t.$message({type:"info",message:"已取消操作!"})})},table_size_change:function(e){this.page_size=e,Object(z.d)(e),this.fetch_system_users()},change_current:function(e){this.page=e,this.fetch_system_users()}}},q=(s("V8Ll"),Object(g.a)($,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"content"},[s("div",{staticClass:"content-body"},[s("div",{staticClass:"search-area"},[s("el-row",{staticClass:"row-bg",attrs:{gutter:10}},[s("el-col",{staticClass:"col-bg",attrs:{xs:12,sm:8,md:6,lg:6,xl:4}},[s("div",{staticClass:"grid-content bg-purple"},[s("el-row",[s("el-col",{staticClass:"order-number-list",attrs:{span:8}},[e._v("用户名:")]),e._v(" "),s("el-col",{attrs:{span:16}},[s("el-input",{attrs:{size:"mini",placeholder:"请输入用户名",clearable:""},on:{change:e.query_condition_change},model:{value:e.query_sets.user_id,callback:function(t){e.$set(e.query_sets,"user_id",t)},expression:"query_sets.user_id"}})],1)],1)],1)]),e._v(" "),s("el-col",{staticClass:"col-bg",attrs:{xs:12,sm:8,md:6,lg:6,xl:4}},[s("div",{staticClass:"grid-content bg-purple-light"},[s("el-row",[s("el-col",{staticClass:"order-number-list",attrs:{span:8}},[e._v("真实姓名:")]),e._v(" "),s("el-col",{attrs:{span:16}},[s("el-input",{attrs:{size:"mini",placeholder:"请输入真实姓名",clearable:""},on:{change:e.query_condition_change},model:{value:e.query_sets.real_name,callback:function(t){e.$set(e.query_sets,"real_name",t)},expression:"query_sets.real_name"}})],1)],1)],1)]),e._v(" "),s("el-col",{staticClass:"col-bg",attrs:{xs:12,sm:8,md:6,lg:6,xl:4}},[s("div",{staticClass:"grid-content bg-purple-light"},[s("el-row",[s("el-col",{staticClass:"order-number-list",attrs:{span:8}},[e._v("角色名称:")]),e._v(" "),s("el-col",{attrs:{span:16}},[s("el-select",{attrs:{size:"mini",filterable:"",remote:"",clearable:"",placeholder:"请选择角色名称"},on:{change:e.query_condition_change},model:{value:e.query_sets.role_id,callback:function(t){e.$set(e.query_sets,"role_id",t)},expression:"query_sets.role_id"}},e._l(e.roles,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1)],1)]),e._v(" "),s("el-col",{staticClass:"col-bg",attrs:{xs:12,sm:8,md:6,lg:6,xl:4}},[s("div",{staticClass:"grid-content bg-purple-light"},[s("el-row",[s("el-col",{staticClass:"order-number-list",attrs:{span:8}},[e._v("状态:")]),e._v(" "),s("el-col",{attrs:{span:16}},[s("el-select",{attrs:{size:"mini",placeholder:"请选择用户当前状态",clearable:""},on:{change:e.query_condition_change},model:{value:e.query_sets.state,callback:function(t){e.$set(e.query_sets,"state",t)},expression:"query_sets.state"}},e._l(e.system_account_enable_state,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1)],1)]),e._v(" "),s("el-col",{staticClass:"col-bg",attrs:{xs:12,sm:8,md:6,lg:6,xl:4}},[s("div",{staticClass:"grid-content bg-purple-light"},[s("el-row",[s("el-col",{staticClass:"order-number-list",attrs:{span:8}},[e._v("账号类型:")]),e._v(" "),s("el-col",{attrs:{span:16}},[s("el-select",{attrs:{size:"mini",placeholder:"请选择账号类型",clearable:""},on:{change:e.query_condition_change},model:{value:e.query_sets.account_type,callback:function(t){e.$set(e.query_sets,"account_type",t)},expression:"query_sets.account_type"}},e._l(e.account_name_list,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1)],1)]),e._v(" "),s("el-col",{staticClass:"col-bg layout-right col-right-button",attrs:{xs:12,sm:8,md:18,lg:18,xl:4}},[s("div",{staticClass:"grid-content bg-purple-light"},[s("el-row",[s("gl-button",{attrs:{pid:"20067",size:"mini",type:"success"},on:{click:e.create_account}},[e._v("创建账号")])],1)],1)])],1)],1),e._v(" "),s("div",{staticClass:"between-search-area-and-table-display"}),e._v(" "),s("div",{staticClass:"table-content table-block"},[s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.resource,size:"mini",stripe:""}},[s("el-table-column",{attrs:{align:"center",label:"序号",prop:"_idx",width:"60"}}),e._v(" "),s("el-table-column",{attrs:{align:"center",label:"账号名称",prop:"user_id",width:"160"}}),e._v(" "),s("el-table-column",{attrs:{align:"center",label:"真实姓名",prop:"real_name",width:"180"}}),e._v(" "),s("el-table-column",{attrs:{align:"center",label:"角色名称",prop:"role_name",width:"180"}}),e._v(" "),s("el-table-column",{attrs:{align:"center",label:"账号类型",prop:"account_name",width:"180"}}),e._v(" "),s("el-table-column",{attrs:{align:"center",label:"最近登录时间",prop:"first_login_time_label"}}),e._v(" "),s("el-table-column",{attrs:{align:"center",label:"创建时间",prop:"create_time_label"}}),e._v(" "),s("el-table-column",{attrs:{width:80,align:"center",label:"状态",prop:"status"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",{class:{green:"1"===t.row.state,red:"0"===t.row.state}},[e._v(e._s(t.row.state_label))])]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"center",label:"操作",prop:"control"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("gl-button",{staticStyle:{"padding-bottom":"2px","border-bottom":"1px solid"},attrs:{disabled:"gladmin"===t.row.user_id,pid:"20068",size:"small",type:"text"},on:{click:function(s){return e.confirm_change_account_state(t.row)}}},[e._v(e._s(e.show_table_button_label(t.row))+"\n            ")]),e._v(" "),s("gl-button",{staticStyle:{"padding-bottom":"2px","border-bottom":"1px solid"},attrs:{disabled:"gladmin"===t.row.user_id,pid:"20069",size:"small",type:"text"},on:{click:function(s){return e.edit_account(t.row)}}},[e._v("编辑\n            ")]),e._v(" "),s("gl-button",{staticStyle:{"padding-bottom":"2px","border-bottom":"1px solid"},attrs:{disabled:"gladmin"===t.row.user_id,pid:"20091",size:"small",type:"text"},on:{click:function(s){return e.reset_account_password(t.row)}}},[e._v("重置密码\n            ")])]}}])})],1),e._v(" "),s("el-pagination",{attrs:{"current-page":e.page,"page-size":e.page_size,"page-sizes":e.page_sizes,total:e.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"current-change":e.change_current,"size-change":e.table_size_change}})],1)]),e._v(" "),e.show_reset_pannel?s("reset-system-account-password",{attrs:{"user-id":e.current_user_id,"show-dialog":e.show_reset_pannel},on:{callback:e.reset_callback}}):e._e(),e._v(" "),e.show_create_or_edit_pannel?s("create-and-edit-system-account",{attrs:{user:e.current_user,roles:e.roles,"show-dialog":e.show_create_or_edit_pannel},on:{callback:e.create_or_edit_callback}}):e._e()],1)},[],!1,null,"4d5a0204",null));t.default=q.exports},V8Ll:function(e,t,s){"use strict";var a=s("+F/X");s.n(a).a},Yfch:function(e,t,s){"use strict";function a(e){return!0}function r(e){return/^(https?|ftp):\/\/([a-zA-Z0-9.-]+(:[a-zA-Z0-9.&%$-]+)*@)*((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])){3}|([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+\.(com|edu|gov|int|mil|net|org|biz|arpa|info|name|pro|aero|coop|museum|[a-zA-Z]{2}))(:[0-9]+)*(\/($|[a-zA-Z0-9.,?'\\+&%$#=~_-]+))*$/.test(e)}function o(e){return/^[\u4e00-\u9fa5]+$/.test(e)?{status:!0,message:"检验中文字符成功"}:{status:!1,message:"不包含中文字符"}}function n(e){var t="密码必须是8-16位字符且包含大小写字母、数字和殊字字符";return/[0-9]/.test(e)&&/[a-zA-Z]/.test(e)&&/[~!@#$%^&*()_+\{\}|":?><\-=\[\];',.]/.test(e)&&/^([a-zA-Z0-9~!@#$%^&*()_+\{\}|":?><\-=\[\];',.]){8,16}$/.test(e)?{status:!0,message:"校验通过"}:{status:!1,message:t}}s.d(t,"a",function(){return a}),s.d(t,"d",function(){return r}),s.d(t,"b",function(){return o}),s.d(t,"c",function(){return n})},fXsU:function(e,t,s){var a=s("5K7Z"),r=s("fNZA");e.exports=s("WEpk").getIterator=function(e){var t=r(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return a(t.call(e))}},gkkV:function(e,t,s){"use strict";var a=s("PTw5");s.n(a).a},iwWg:function(e,t,s){"use strict";var a=s("lVSS");s.n(a).a},lVSS:function(e,t,s){}}]);