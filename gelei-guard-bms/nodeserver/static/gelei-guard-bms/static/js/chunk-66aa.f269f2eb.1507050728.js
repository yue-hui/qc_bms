(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-66aa"],{"5DP5":function(e,t,i){"use strict";i.r(t);var s=i("YP4+"),a=i("X4fA"),n=i("S583"),l=i("z0WU"),r={props:{device_info:{type:Object,default:function(){return{}}}},data:function(){return{date_range:null,list:[],pagination:{page_sizes:s.V,current_page:1,total:40,page_size:Object(a.a)()},pickerOptions:{disabledDate:function(e){var t=(new Date).getTime(),i=t-6048e5;return e.getTime()>t||e.getTime()<i}},query_all:!1,send_ins_loading:!1,query_loading:!1,send_ins_msg:"",timer:null,visiable_height:0,device_id:""}},mounted:function(){this.visiable_height=document.documentElement.clientHeight+"px",this.device_id=this.device_info.device_id,this.query()},methods:{device_upload_logs_close:function(){this.$emit("device_upload_logs_close")},send_ins:function(){var e=this,t="",i="";return Array.isArray(this.date_range)&&2===this.date_range.length?(t=String(this.date_range[0].getTime()),i=String(this.date_range[1].getTime()+864e5),this.device_id?(this.send_ins_loading=!0,void Object(n.w)({device_id:this.device_id,start_date:t,end_date:i,query_event:this.query_all}).then(function(t){0===t.status?e.$message.success(t.message):e.$message.error(t.message)}).finally(function(){e.send_ins_loading=!1})):(this.send_ins_msg="必须填写设备号",clearTimeout(this.timer),this.timer=setTimeout(function(){e.send_ins_msg=""},2e3))):(this.send_ins_msg="必须选择时间",clearTimeout(this.timer),this.timer=setTimeout(function(){e.send_ins_msg=""},2e3))},query:function(){var e=this;if(!this.device_id)return this.send_ins_msg="必须填写设备号",clearTimeout(this.timer),this.timer=setTimeout(function(){e.send_ins_msg=""},2e3);this.query_loading=!0,Object(n.db)({device_id:this.device_id}).then(function(t){0===t.status?e.list=t.data.map(function(e){return e.uploadTime=Object(l.b)(Number(e.uploadTime),s.p),e}):e.$message.error(t.message)}).finally(function(){e.query_loading=!1})},change_current:function(e){},table_size_change:function(e){}}},c=(i("sE8C"),i("KHd+")),d=Object(c.a)(r,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"component-card-with-dialog"},[i("div",{staticClass:"component-card"},[i("div",{staticClass:"dialog",style:{"max-height":e.visiable_height}},[i("div",{staticClass:"head-area"},[i("div",{staticClass:"title"},[e._v("运行日志记录")]),e._v(" "),i("div",{staticClass:"close-icon"},[i("i",{staticClass:"el-message-box__close el-icon-close",on:{click:e.device_upload_logs_close}})])]),e._v(" "),i("div",{staticClass:"body-area"},[i("div",{staticClass:"filter"},[i("div",{staticClass:"date-time"},[i("span",{staticClass:"filter-label",staticStyle:{"font-size":"14px"}},[e._v("时间：")]),e._v(" "),i("el-date-picker",{staticStyle:{width:"330px"},attrs:{"picker-options":e.pickerOptions,size:"mini",type:"daterange",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.date_range,callback:function(t){e.date_range=t},expression:"date_range"}}),e._v(" "),i("span",{staticClass:"filter-label",staticStyle:{"font-size":"14px","margin-left":"10px"}},[e._v("设备号：")]),e._v(" "),i("el-input",{staticStyle:{width:"332px"},attrs:{clearable:"",size:"mini",placeholder:"请输入设备号"},model:{value:e.device_id,callback:function(t){e.device_id=t},expression:"device_id"}})],1)]),e._v(" "),i("div",{staticClass:"device-id-input"},[i("div",[i("span",{staticClass:"filter-label",staticStyle:{"font-size":"14px","margin-right":"6px"}},[e._v("查询全部：")]),e._v(" "),i("el-checkbox",{model:{value:e.query_all,callback:function(t){e.query_all=t},expression:"query_all"}}),e._v(" "),i("span",{staticClass:"error-msg"},[e._v(e._s(e.send_ins_msg))])],1),e._v(" "),i("div",{staticClass:"btn"},[i("el-button",{attrs:{loading:e.send_ins_loading,size:"mini",type:"info"},on:{click:e.send_ins}},[e._v("发送指令")]),e._v(" "),i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.query}},[e._v("查询")])],1)]),e._v(" "),i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.query_loading,expression:"query_loading"}],staticClass:"table-content table-block"},[i("el-table",{attrs:{data:e.list,size:"mini",stripe:""}},[i("el-table-column",{attrs:{align:"center",width:"50",label:"ID",prop:"recordId"}}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"日志地址(点击下载)",prop:"url"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("a",{staticStyle:{"margin-left":"10px"},attrs:{href:t.row.url,title:t.row.url,target:"_blank"}},[e._v("\n                  "+e._s(t.row.url)+"\n                ")])]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"上传时间",width:"180",prop:"uploadTime"}})],1),e._v(" "),e._e()],1)])])])])},[],!1,null,"10a4d564",null);t.default=d.exports},MUaU:function(e,t,i){},sE8C:function(e,t,i){"use strict";var s=i("MUaU");i.n(s).a}}]);